<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>2. NEWS</title>
<link rel="stylesheet" type="text/css" href="vg_basic.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="index.html" title="Valgrind Documentation">
<link rel="up" href="dist.html" title="Valgrind Distribution Documents">
<link rel="prev" href="dist.authors.html" title="1. AUTHORS">
<link rel="next" href="dist.news.old.html" title="3. OLDER NEWS">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div><table class="nav" width="100%" cellspacing="3" cellpadding="3" border="0" summary="Navigation header"><tr>
<td width="22px" align="center" valign="middle"><a accesskey="p" href="dist.authors.html"><img src="images/prev.png" width="18" height="21" border="0" alt="Prev"></a></td>
<td width="25px" align="center" valign="middle"><a accesskey="u" href="dist.html"><img src="images/up.png" width="21" height="18" border="0" alt="Up"></a></td>
<td width="31px" align="center" valign="middle"><a accesskey="h" href="index.html"><img src="images/home.png" width="27" height="20" border="0" alt="Up"></a></td>
<th align="center" valign="middle">Valgrind Distribution Documents</th>
<td width="22px" align="center" valign="middle"><a accesskey="n" href="dist.news.old.html"><img src="images/next.png" width="18" height="21" border="0" alt="Next"></a></td>
</tr></table></div>
<div class="chapter">
<div class="titlepage"><div><div><h1 class="title">
<a name="dist.news"></a>2. NEWS</h1></div></div></div>
<div class="literallayout"><p><br>
      <br>
Release 3.11.0 (22 September 2015)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
<br>
3.11.0 is a feature release with many improvements and the usual<br>
collection of bug fixes.<br>
<br>
This release supports X86/Linux, AMD64/Linux, ARM32/Linux,<br>
ARM64/Linux, PPC32/Linux, PPC64BE/Linux, PPC64LE/Linux, S390X/Linux,<br>
MIPS32/Linux, MIPS64/Linux, ARM/Android, ARM64/Android,<br>
MIPS32/Android, X86/Android, X86/Solaris, AMD64/Solaris, X86/MacOSX<br>
10.10 and AMD64/MacOSX 10.10.  There is also preliminary support for<br>
X86/MacOSX 10.11, AMD64/MacOSX 10.11 and TILEGX/Linux.<br>
<br>
* ================== PLATFORM CHANGES =================<br>
<br>
* Support for Solaris/x86 and Solaris/amd64 has been added.<br>
<br>
* Preliminary support for Mac OS X 10.11 (El Capitan) has been added.<br>
<br>
* Preliminary support for the Tilera TileGX architecture has been added.<br>
<br>
* s390x: It is now required for the host to have the "long displacement"<br>
  facility.  The oldest supported machine model is z990.<br>
<br>
* x86: on an SSE2 only host, Valgrind in 32 bit mode now claims to be a<br>
  Pentium 4.  3.10.1 wrongly claimed to be a Core 2, which is SSSE3.<br>
<br>
* The JIT's register allocator is significantly faster, making the JIT<br>
  as a whole somewhat faster, so JIT-intensive activities, for example<br>
  program startup, are modestly faster, around 5%.<br>
<br>
* There have been changes to the default settings of several command<br>
  line flags, as detailed below.<br>
<br>
* Intel AVX2 support is more complete (64 bit targets only).  On AVX2<br>
  capable hosts, the simulated CPUID will now indicate AVX2 support.<br>
<br>
* ==================== TOOL CHANGES ====================<br>
<br>
* Memcheck:<br>
<br>
  - The default value for --leak-check-heuristics has been changed from<br>
    "none" to "all". This helps to reduce the number of possibly<br>
    lost blocks, in particular for C++ applications.<br>
<br>
  - The default value for --keep-stacktraces has been changed from<br>
    "malloc-then-free" to "malloc-and-free".  This has a small cost in<br>
    memory (one word per malloc-ed block) but allows Memcheck to show the<br>
    3 stacktraces of a dangling reference: where the block was allocated,<br>
    where it was freed, and where it is acccessed after being freed.<br>
<br>
  - The default value for --partial-loads-ok has been changed from "no" to <br>
    "yes", so as to avoid false positive errors resulting from some kinds<br>
    of vectorised loops.<br>
<br>
  - A new monitor command 'xb &lt;addr&gt; &lt;len&gt;' shows the validity bits of<br>
    &lt;len&gt; bytes at &lt;addr&gt;.  The monitor command 'xb' is easier to use<br>
    than get_vbits when you need to associate byte data value with<br>
    their corresponding validity bits.<br>
<br>
  - The 'block_list' monitor command has been enhanced:<br>
      o it can print a range of loss records<br>
      o it now accepts an optional argument 'limited &lt;max_blocks&gt;'<br>
        to control the number of blocks printed.<br>
      o if a block has been found using a heuristic, then<br>
        'block_list' now shows the heuristic after the block size.<br>
      o the loss records/blocks to print can be limited to the blocks<br>
        found via specified heuristics.<br>
<br>
  - The C helper functions used to instrument loads on<br>
    x86-{linux,solaris} and arm-linux (both 32-bit only) have been<br>
    replaced by handwritten assembly sequences.  This gives speedups<br>
    in the region of 0% to 7% for those targets only.<br>
<br>
  - A new command line option, --expensive-definedness-checks=yes|no,<br>
    has been added.  This is useful for avoiding occasional invalid<br>
    uninitialised-value errors in optimised code.  Watch out for<br>
    runtime degradation, as this can be up to 25%.  As always, though,<br>
    the slowdown is highly application specific.  The default setting<br>
    is "no".<br>
<br>
* Massif:<br>
<br>
  - A new monitor command 'all_snapshots &lt;filename&gt;' dumps all<br>
    snapshots taken so far.<br>
<br>
* Helgrind:<br>
<br>
  - Significant memory reduction and moderate speedups for<br>
    --history-level=full for applications accessing a lot of memory<br>
    with many different stacktraces.<br>
<br>
  - The default value for --conflict-cache-size=N has been doubled to<br>
    2000000.  Users that were not using the default value should<br>
    preferably also double the value they give.<br>
<br>
    The default was changed due to the changes in the "full history"<br>
    implementation.  Doubling the value gives on average a slightly more<br>
    complete history and uses similar memory (or significantly less memory<br>
    in the worst case) than the previous implementation.<br>
    <br>
  - The Helgrind monitor command 'info locks' now accepts an optional<br>
    argument 'lock_addr', which shows information about the lock at the<br>
    given address only.<br>
<br>
  - When using --history-level=full, the new Helgrind monitor command<br>
    'accesshistory &lt;addr&gt; [&lt;len&gt;]' will show the recorded accesses for<br>
    &lt;len&gt; (or 1) bytes at &lt;addr&gt;.<br>
<br>
* ==================== OTHER CHANGES ====================<br>
<br>
* The default value for the --smc-check option has been changed from<br>
  "stack" to "all-non-file" on targets that provide automatic D-I<br>
  cache coherence (x86, amd64 and s390x).  The result is to provide,<br>
  by default, transparent support for JIT generated and self-modifying<br>
  code on all targets.<br>
<br>
* Mac OS X only: the default value for the --dsymutil option has been<br>
  changed from "no" to "yes", since any serious usage on Mac OS X<br>
  always required it to be "yes".<br>
<br>
* The command line options --db-attach and --db-command have been removed.<br>
  They were deprecated in 3.10.0.<br>
<br>
* When a process dies due to a signal, Valgrind now shows the signal<br>
  and the stacktrace at default verbosity (i.e. verbosity 1).<br>
<br>
* The address description logic used by Memcheck and Helgrind now<br>
  describes addresses in anonymous segments, file mmap-ed segments,<br>
  shared memory segments and the brk data segment.<br>
<br>
* The new option --error-markers=&lt;begin&gt;,&lt;end&gt; can be used to mark the<br>
  begin/end of errors in textual output mode, to facilitate<br>
  searching/extracting errors in output files that mix valgrind errors<br>
  with program output.<br>
<br>
* The new option --max-threads=&lt;number&gt; can be used to change the number<br>
  of threads valgrind can handle.  The default is 500 threads which<br>
  should be more than enough for most applications.<br>
<br>
* The new option --valgrind-stacksize=&lt;number&gt; can be used to change the<br>
  size of the private thread stacks used by Valgrind.  This is useful<br>
  for reducing memory use or increasing the stack size if Valgrind<br>
  segfaults due to stack overflow.<br>
<br>
* The new option --avg-transtab-entry-size=&lt;number&gt; can be used to specify<br>
  the expected instrumented block size, either to reduce memory use or<br>
  to avoid excessive retranslation.<br>
<br>
* Valgrind can be built with Intel's ICC compiler, version 14.0 or later.<br>
<br>
* New and modified GDB server monitor features:<br>
<br>
  - When a signal is reported in GDB, you can now use the GDB convenience<br>
    variable $_siginfo to examine detailed signal information.<br>
 <br>
  - Valgrind's gdbserver now allows the user to change the signal<br>
    to deliver to the process.  So, use 'signal SIGNAL' to continue execution<br>
    with SIGNAL instead of the signal reported to GDB. Use 'signal 0' to<br>
    continue without passing the signal to the process.<br>
<br>
  - With GDB &gt;= 7.10, the command 'target remote'<br>
    will automatically load the executable file of the process running<br>
    under Valgrind. This means you do not need to specify the executable<br>
    file yourself, GDB will discover it itself.  See GDB documentation about<br>
    'qXfer:exec-file:read' packet for more info.<br>
<br>
* ==================== FIXED BUGS ====================<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (https://bugs.kde.org/enter_bug.cgi?product=valgrind) rather<br>
than mailing the developers (or mailing lists) directly -- bugs that<br>
are not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
  https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
116002  VG_(printf): Problems with justification of strings and integers<br>
155125  avoid cutting away file:lineno after long function name<br>
197259  Unsupported arch_prtctl PR_SET_GS option<br>
201152  ppc64: Assertion in ppc32g_dirtyhelper_MFSPR_268_269<br>
201216  Fix Valgrind does not support pthread_sigmask() on OS X<br>
201435  Fix Darwin: -v does not show kernel version<br>
208217  "Warning: noted but unhandled ioctl 0x2000747b" on Mac OS X<br>
211256  Fixed an outdated comment regarding the default platform.<br>
211529  Incomplete call stacks for code compiled by newer versions of MSVC<br>
211926  Avoid compilation warnings in valgrind.h with -pedantic<br>
212291  Fix unhandled syscall: unix:132 (mkfifo) on OS X<br>
        == 263119<br>
226609  Crediting upstream authors in man page<br>
231257  Valgrind omits path when executing script from shebang line<br>
254164  OS X task_info: UNKNOWN task message [id 3405, to mach_task_self() [..]<br>
269360  s390x: Fix addressing mode selection for compare-and-swap<br>
302630  Memcheck: Assertion failed: 'sizeof(UWord) == sizeof(UInt)'<br>
        == 326797<br>
312989  ioctl handling needs to do POST handling on generic ioctls and [..]<br>
319274  Fix unhandled syscall: unix:410 (sigsuspend_nocancel) on OS X<br>
324181  mmap does not handle MAP_32BIT (handle it now, rather than fail it)<br>
327745  Fix valgrind 3.9.0 build fails on Mac OS X 10.6.8<br>
330147  libmpiwrap PMPI_Get_count returns undefined value<br>
333051  mmap of huge pages fails due to incorrect alignment<br>
        == 339163<br>
334802  valgrind does not always explain why a given option is bad<br>
335618  mov.w rN, pc/sp (ARM32)<br>
335785  amd64-&gt;IR 0xC4 0xE2 0x75 0x2F (vmaskmovpd)<br>
        == 307399<br>
        == 343175<br>
        == 342740<br>
        == 346912<br>
335907  segfault when running wine's ddrawex/tests/surface.c under valgrind<br>
338602  AVX2 bit in CPUID missing<br>
338606  Strange message for scripts with invalid interpreter<br>
338731  ppc: Fix testuite build for toolchains not supporting -maltivec<br>
338995  shmat with hugepages (SHM_HUGETLB) fails with EINVAL<br>
339045  Getting valgrind to compile and run on OS X Yosemite (10.10)<br>
        == 340252<br>
339156  gdbsrv not called for fatal signal<br>
339215  Valgrind 3.10.0 contain 2013 in copyrights notice<br>
339288  support Cavium Octeon MIPS specific BBIT*32 instructions<br>
339636  Use fxsave64 and fxrstor64 mnemonics instead of old-school rex64 prefix<br>
339442  Fix testsuite build failure on OS X 10.9<br>
339542  Enable compilation with Intel's ICC compiler<br>
339563  The DVB demux DMX_STOP ioctl doesn't have a wrapper<br>
339688  Mac-specific ASM does not support .version directive (cpuid,<br>
        tronical and pushfpopf tests)<br>
339745  Valgrind crash when check Marmalade app (partial fix)<br>
339755  Fix known deliberate memory leak in setenv() on Mac OS X 10.9<br>
339778  Linux/TileGx platform support for Valgrind<br>
339780  Fix known uninitialised read in pthread_rwlock_init() on Mac OS X 10.9 <br>
339789  Fix none/tests/execve test on Mac OS X 10.9<br>
339808  Fix none/tests/rlimit64_nofile test on Mac OS X 10.9<br>
339820  vex amd64-&gt;IR: 0x66 0xF 0x3A 0x63 0xA 0x42 0x74 0x9 (pcmpistri $0x42)<br>
340115  Fix none/tests/cmdline[1|2] tests on systems which define TMPDIR<br>
340392  Allow user to select more accurate definedness checking in memcheck<br>
        to avoid invalid complaints on optimised code<br>
340430  Fix some grammatical weirdness in the manual.<br>
341238  Recognize GCC5/DWARFv5 DW_LANG constants (Go, C11, C++11, C++14)<br>
341419  Signal handler ucontext_t not filled out correctly on OS X<br>
341539  VG_(describe_addr) should not describe address as belonging to client<br>
        segment if it is past the heap end<br>
341613  Enable building of manythreads and thread-exits tests on Mac OS X<br>
341615  Fix none/tests/darwin/access_extended test on Mac OS X<br>
341698  Valgrind's AESKEYGENASSIST gives wrong result in words 0 and 2 [..]<br>
341789  aarch64: shmat fails with valgrind on ARMv8<br>
341997  MIPS64: Cavium OCTEON insns - immediate operand handled incorrectly<br>
342008  valgrind.h needs type cast [..] for clang/llvm in 64-bit mode<br>
342038  Unhandled syscalls on aarch64 (mbind/get/set_mempolicy)<br>
342063  wrong format specifier for test mcblocklistsearch in gdbserver_tests<br>
342117  Hang when loading PDB file for MSVC compiled Firefox under Wine<br>
342221  socket connect false positive uninit memory for unknown af family<br>
342353  Allow dumping full massif output while valgrind is still running<br>
342571  Valgrind chokes on AVX compare intrinsic with _CMP_GE_QS<br>
        == 346476<br>
        == 348387<br>
        == 350593<br>
342603  Add I2C_SMBUS ioctl support<br>
342635  OS X 10.10 (Yosemite) - missing system calls and fcntl code<br>
342683  Mark memory past the initial brk limit as unaddressable<br>
342783  arm: unhandled instruction 0xEEFE1ACA = "vcvt.s32.f32 s3, s3, #12"<br>
342795  Internal glibc __GI_mempcpy call should be intercepted<br>
342841  s390x: Support instructions fiebr(a) and fidbr(a)<br>
343012  Unhandled syscall 319 (memfd_create)<br>
343069  Patch updating v4l2 API support<br>
343173  helgrind crash during stack unwind<br>
343219  fix GET_STARTREGS for arm<br>
343303  Fix known deliberate memory leak in setenv() on Mac OS X 10.10<br>
343306  OS X 10.10: UNKNOWN mach_msg unhandled MACH_SEND_TRAILER option<br>
343332  Unhandled instruction 0x9E310021 (fcvtmu) on aarch64<br>
343335  unhandled instruction 0x1E638400 (fccmp) aarch64<br>
343523  OS X mach_ports_register: UNKNOWN task message [id 3403, to [..]<br>
343525  OS X host_get_special_port: UNKNOWN host message [id 412, to [..]<br>
343597  ppc64le: incorrect use of offseof macro<br>
343649  OS X host_create_mach_voucher: UNKNOWN host message [id 222, to [..]<br>
343663  OS X 10.10  Memchecj always reports a leak regardless of [..]<br>
343732  Unhandled syscall 144 (setgid) on aarch64<br>
343733  Unhandled syscall 187 (msgctl and related) on aarch64<br>
343802  s390x: False positive "conditional jump or move depends on [..]<br>
343902  --vgdb=yes doesn't break when --xml=yes is used<br>
343967  Don't warn about setuid/setgid/setcap executable for directories<br>
343978  Recognize DWARF5/GCC5 DW_LANG_Fortran 2003 and 2008 constants<br>
344007  accept4 syscall unhandled on arm64 (242) and ppc64 (344)<br>
344033  Helgrind on ARM32 loses track of mutex state in pthread_cond_wait<br>
344054  www - update info for Solaris/illumos<br>
344416  'make regtest' does not work cleanly on OS X<br>
344235  Remove duplicate include of pub_core_aspacemgr.h<br>
344279  syscall sendmmsg on arm64 (269) and ppc32/64 (349) unhandled<br>
344295  syscall recvmmsg on arm64 (243) and ppc32/64 (343) unhandled<br>
344307  2 unhandled syscalls on aarch64/arm64: umount2(39), mount (40)<br>
344314  callgrind_annotate ... warnings about commands containing newlines<br>
344318  socketcall should wrap recvmmsg and sendmmsg<br>
344337  Fix unhandled syscall: mach:41 (_kernelrpc_mach_port_guard_trap)<br>
344416  Fix 'make regtest' does not work cleanly on OS X<br>
344499  Fix compilation for Linux kernel &gt;= 4.0.0<br>
344512  OS X: unhandled syscall: unix:348 (__pthread_chdir), <br>
        unix:349 (__pthread_fchdir)<br>
344559  Garbage collection of unused segment names in address space manager<br>
344560  Fix stack traces missing penultimate frame on OS X<br>
344621  Fix memcheck/tests/err_disable4 test on OS X<br>
344686  Fix suppression for pthread_rwlock_init on OS X 10.10<br>
344702  Fix missing libobjc suppressions on OS X 10.10<br>
        == 344543<br>
344936  Fix unhandled syscall: unix:473 (readlinkat) on OS X 10.10<br>
344939  Fix memcheck/tests/xml1 on OS X 10.10<br>
345016  helgrind/tests/locked_vs_unlocked2 is failing sometimes<br>
345079  Fix build problems in VEX/useful/test_main.c<br>
345126  Incorrect handling of VIDIOC_G_AUDIO and G_AUDOUT<br>
345177  arm64: prfm (reg) not implemented<br>
345215  Performance improvements for the register allocator<br>
345248  add support for Solaris OS in valgrind<br>
345338  TIOCGSERIAL and TIOCSSERIAL ioctl support on Linux<br>
345394  Fix memcheck/tests/strchr on OS X<br>
345637  Fix memcheck/tests/sendmsg on OS X<br>
345695  Add POWERPC support for AT_DCACHESIZE and HWCAP2<br>
345824  Fix aspacem segment mismatch: seen with none/tests/bigcode<br>
345887  Fix an assertion in the address space manager<br>
345928  amd64: callstack only contains current function for small stacks<br>
345984  disInstr(arm): unhandled instruction: 0xEE193F1E<br>
345987  MIPS64: Implement cavium LHX instruction<br>
346031  MIPS: Implement support for the CvmCount register (rhwr %0, 31)<br>
346185  Fix typo saving altivec register v24<br>
346267  Compiler warnings for PPC64 code on call to LibVEX_GuestPPC64_get_XER()<br>
        and LibVEX_GuestPPC64_get_CR()<br>
346270  Regression tests none/tests/jm_vec/isa_2_07 and<br>
        none/tests/test_isa_2_07_part2 have failures on PPC64 little endian<br>
346307  fuse filesystem syscall deadlocks<br>
346324  PPC64 missing support for lbarx, lharx, stbcx and sthcx instructions<br>
346411  MIPS: SysRes::_valEx handling is incorrect<br>
346416  Add support for LL_IOC_PATH2FID and LL_IOC_GETPARENT Lustre ioctls<br>
346474  PPC64 Power 8, spr TEXASRU register not supported<br>
346487  Compiler generates "note" about a future ABI change for PPC64<br>
346562  MIPS64: lwl/lwr instructions are performing 64bit loads<br>
        and causing spurious "invalid read of size 8" warnings<br>
346801  Fix link error on OS X: _vgModuleLocal_sf_maybe_extend_stack<br>
347151  Fix suppression for pthread_rwlock_init on OS X 10.8<br>
347233  Fix memcheck/tests/strchr on OS X 10.10 (Haswell) <br>
347322  Power PC regression test cleanup<br>
347379  valgrind --leak-check=full leak errors from system libs on OS X 10.8<br>
        == 217236<br>
347389  unhandled syscall: 373 (Linux ARM syncfs)<br>
347686  Patch set to cleanup PPC64 regtests<br>
347978  Remove bash dependencies where not needed<br>
347982  OS X: undefined symbols for architecture x86_64: "_global" [..]<br>
347988  Memcheck: the 'impossible' happened: unexpected size for Addr (OSX/wine)<br>
        == 345929<br>
348102  Patch updating v4l2 API support<br>
348247  amd64 front end: jno jumps wrongly when overflow is not set<br>
348269  Improve mmap MAP_HUGETLB support.<br>
348334  (ppc) valgrind does not simulate dcbfl - then my program terminates<br>
348345  Assertion fails for negative lineno<br>
348377  Unsupported ARM instruction: yield<br>
348565  Fix detection of command line option availability for clang<br>
348574  vex amd64-&gt;IR pcmpistri SSE4.2 unsupported (pcmpistri $0x18)<br>
348728  Fix broken check for VIDIOC_G_ENC_INDEX<br>
348748  Fix redundant condition<br>
348890  Fix clang warning about unsupported --param inline-unit-growth=900<br>
348949  Bogus "ERROR: --ignore-ranges: suspiciously large range"<br>
349034  Add Lustre ioctls LL_IOC_GROUP_LOCK and LL_IOC_GROUP_UNLOCK<br>
349086  Fix UNKNOWN task message [id 3406, to mach_task_self(), [..]<br>
349087  Fix UNKNOWN task message [id 3410, to mach_task_self(), [..]<br>
349626  Implemented additional Xen hypercalls<br>
349769  Clang/osx: ld: warning: -read_only_relocs cannot be used with x86_64<br>
349790  Clean up of the hardware capability checking utilities.<br>
349828  memcpy intercepts memmove causing src/dst overlap error (ppc64 ld.so)<br>
349874  Fix typos in source code<br>
349879  memcheck: add handwritten assembly for helperc_LOADV*<br>
349941  di_notify_mmap might create wrong start/size DebugInfoMapping<br>
350062  vex x86-&gt;IR: 0x66 0xF 0x3A 0xB (ROUNDSD) on OS X<br>
350202  Add limited param to 'monitor block_list'<br>
350290  s390x: Support instructions fixbr(a)<br>
350359  memcheck/tests/x86/fxsave hangs indefinetely on OS X<br>
350809  Fix none/tests/async-sigs for Solaris<br>
350811  Remove reference to --db-attach which has been removed.<br>
350813  Memcheck/x86: enable handwritten assembly helpers for x86/Solaris too<br>
350854  hard-to-understand code in VG_(load_ELF)()<br>
351140  arm64 syscalls setuid (146) and setresgid (149) not implemented<br>
351386  Solaris: Cannot run ld.so.1 under Valgrind<br>
351474  Fix VG_(iseqsigset) as obvious<br>
351534  Fix incorrect header guard<br>
351632  Fix UNKNOWN fcntl 97 on OS X 10.11<br>
351756  Intercept platform_memchr$VARIANT$Haswell on OS X<br>
351858  ldsoexec support on Solaris<br>
351873  Newer gcc doesn't allow __builtin_tabortdc[i] in ppc32 mode<br>
352130  helgrind reports false races for printfs using mempcpy on FILE* state<br>
352284  s390: Conditional jump depends on uninitialised value(s) in vfprintf <br>
352320  arm64 crash on none/tests/nestedfs<br>
352765  Vbit test fails on Power 6<br>
352768  The mbar instruction is missing from the Power PC support<br>
352769  Power PC program priority register (PPR) is not supported<br>
n-i-bz  Provide implementations of certain compiler builtins to support<br>
        compilers that may not provide those<br>
n-i-bz  Old STABS code is still being compiled, but never used. Remove it.<br>
n-i-bz  Fix compilation on distros with glibc &lt; 2.5<br>
n-i-bz  (vex 3098) Avoid generation of Neon insns on non-Neon hosts<br>
n-i-bz  Enable rt_sigpending syscall on ppc64 linux.<br>
n-i-bz  mremap did not work properly on shared memory<br>
n-i-bz  Fix incorrect sizeof expression in syswrap-xen.c reported by Coverity<br>
n-i-bz  In VALGRIND_PRINTF write out thread name, if any, to xml<br>
<br>
(3.11.0.TEST1:  8 September 2015, vex r3187, valgrind r15646)<br>
(3.11.0.TEST2: 21 September 2015, vex r3193, valgrind r15667)<br>
(3.11.0:       22 September 2015, vex r3195, valgrind r15674)<br>
<br>
<br>
<br>
Release 3.10.1 (25 November 2014)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.10.1 is a bug fix release.  It fixes various bugs reported in 3.10.0<br>
and backports fixes for all reported missing AArch64 ARMv8 instructions<br>
and syscalls from the trunk.  If you package or deliver 3.10.0 for others<br>
to use, you might want to consider upgrading to 3.10.1 instead.<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (https://bugs.kde.org/enter_bug.cgi?product=valgrind) rather<br>
than mailing the developers (or mailing lists) directly -- bugs that<br>
are not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
  https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
335440  arm64: ld1 (single structure) is not implemented<br>
335713  arm64: unhanded instruction: prfm (immediate)<br>
339020  ppc64: memcheck/tests/ppc64/power_ISA2_05 failing in nightly build<br>
339182  ppc64: AvSplat ought to load destination vector register with [..]<br>
339336  PPC64 store quad instruction (stq) is not supposed to change [..]<br>
339433  ppc64 lxvw4x instruction uses four 32-byte loads<br>
339645  Use correct tag names in sys_getdents/64 wrappers<br>
339706  Fix false positive for ioctl(TIOCSIG) on linux<br>
339721  assertion 'check_sibling == sibling' failed in readdwarf3.c ...<br>
339853  arm64 times syscall unknown<br>
339855  arm64 unhandled getsid/setsid syscalls<br>
339858  arm64 dmb sy not implemented<br>
339926  Unhandled instruction 0x1E674001 (frintx) on aarm64<br>
339927  Unhandled instruction 0x9E7100C6 (fcvtmu) on aarch64<br>
339938  disInstr(arm64): unhandled instruction 0x4F8010A4 (fmla)<br>
        == 339950<br>
339940  arm64: unhandled syscall: 83 (sys_fdatasync) + patch<br>
340033  arm64: unhandled insn dmb ishld and some other isb-dmb-dsb variants<br>
340028  unhandled syscalls for arm64 (msync, pread64, setreuid and setregid)<br>
340036  arm64: Unhandled instruction ld4 (multiple structures, no offset)<br>
340236  arm64: unhandled syscalls: mknodat, fchdir, chroot, fchownat<br>
340509  arm64: unhandled instruction fcvtas<br>
340630  arm64: fchmod (52) and fchown (55) syscalls not recognized<br>
340632  arm64: unhandled instruction fcvtas<br>
340722  Resolve "UNKNOWN attrlist flags 0:0x10000000"<br>
340725  AVX2: Incorrect decoding of vpbroadcast{b,w} reg,reg forms<br>
340788  warning: unhandled syscall: 318 (getrandom)<br>
340807  disInstr(arm): unhandled instruction: 0xEE989B20<br>
340856  disInstr(arm64): unhandled instruction 0x1E634C45 (fcsel)<br>
340922  arm64: unhandled getgroups/setgroups syscalls<br>
350251  Fix typo in VEX utility program (test_main.c).<br>
350407  arm64: unhandled instruction ucvtf (vector, integer)<br>
350809  none/tests/async-sigs breaks when run under cron on Solaris<br>
350811  update README.solaris after r15445<br>
350813  Use handwritten memcheck assembly helpers on x86/Solaris [..]<br>
350854  strange code in VG_(load_ELF)()<br>
351140  arm64 syscalls setuid (146) and setresgid (149) not implemented<br>
n-i-bz  DRD and Helgrind: Handle Imbe_CancelReservation (clrex on ARM)<br>
n-i-bz  Add missing ]] to terminate CDATA.<br>
n-i-bz  Glibc versions prior to 2.5 do not define PTRACE_GETSIGINFO<br>
n-i-bz  Enable sys_fadvise64_64 on arm32.<br>
n-i-bz  Add test cases for all remaining AArch64 SIMD, FP and memory insns.<br>
n-i-bz  Add test cases for all known arm64 load/store instructions.<br>
n-i-bz  PRE(sys_openat): when checking whether ARG1 == VKI_AT_FDCWD [..]<br>
n-i-bz  Add detection of old ppc32 magic instructions from bug 278808.<br>
n-i-bz  exp-dhat: Implement missing function "dh_malloc_usable_size".<br>
n-i-bz  arm64: Implement "fcvtpu w, s".<br>
n-i-bz  arm64: implement ADDP and various others<br>
n-i-bz  arm64: Implement {S,U}CVTF (scalar, fixedpt).<br>
n-i-bz  arm64: enable FCVT{A,N}S X,S.<br>
<br>
(3.10.1: 25 November 2014, vex r3026, valgrind r14785)<br>
<br>
<br>
<br>
Release 3.10.0 (10 September 2014)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
<br>
3.10.0 is a feature release with many improvements and the usual<br>
collection of bug fixes.<br>
<br>
This release supports X86/Linux, AMD64/Linux, ARM32/Linux, ARM64/Linux,<br>
PPC32/Linux, PPC64BE/Linux, PPC64LE/Linux, S390X/Linux, MIPS32/Linux,<br>
MIPS64/Linux, ARM/Android, MIPS32/Android, X86/Android, X86/MacOSX 10.9<br>
and AMD64/MacOSX 10.9.  Support for MacOSX 10.8 and 10.9 is<br>
significantly improved relative to the 3.9.0 release.<br>
<br>
* ================== PLATFORM CHANGES =================<br>
<br>
* Support for the 64-bit ARM Architecture (AArch64 ARMv8).  This port<br>
  is mostly complete, and is usable, but some SIMD instructions are as<br>
  yet unsupported.<br>
<br>
* Support for little-endian variant of the 64-bit POWER architecture.<br>
<br>
* Support for Android on MIPS32.<br>
<br>
* Support for 64bit FPU on MIPS32 platforms.<br>
<br>
* Both 32- and 64-bit executables are supported on MacOSX 10.8 and 10.9.<br>
<br>
* Configuration for and running on Android targets has changed.<br>
  See README.android in the source tree for details.<br>
<br>
* ================== DEPRECATED FEATURES =================<br>
<br>
* --db-attach is now deprecated and will be removed in the next<br>
  valgrind feature release.  The built-in GDB server capabilities are<br>
  superior and should be used instead. Learn more here:<br>
  http://valgrind.org/docs/manual/manual-core-adv.html#manual-core-adv.gdbserver<br>
<br>
* ==================== TOOL CHANGES ====================<br>
<br>
* Memcheck:<br>
<br>
  - Client code can now selectively disable and re-enable reporting of<br>
    invalid address errors in specific ranges using the new client<br>
    requests VALGRIND_DISABLE_ADDR_ERROR_REPORTING_IN_RANGE and<br>
    VALGRIND_ENABLE_ADDR_ERROR_REPORTING_IN_RANGE.<br>
<br>
  - Leak checker: there is a new leak check heuristic called<br>
    "length64".  This is used to detect interior pointers pointing 8<br>
    bytes inside a block, on the assumption that the first 8 bytes<br>
    holds the value "block size - 8".  This is used by<br>
    sqlite3MemMalloc, for example.<br>
<br>
  - Checking of system call parameters: if a syscall parameter<br>
    (e.g. bind struct sockaddr, sendmsg struct msghdr, ...) has<br>
    several fields not initialised, an error is now reported for each<br>
    field. Previously, an error was reported only for the first<br>
    uninitialised field.<br>
<br>
  - Mismatched alloc/free checking: a new flag<br>
    --show-mismatched-frees=no|yes [yes] makes it possible to turn off<br>
    such checks if necessary.<br>
<br>
* Helgrind:<br>
<br>
  - Improvements to error messages:<br>
<br>
    o Race condition error message involving heap allocated blocks also<br>
      show the thread number that allocated the raced-on block.<br>
<br>
    o All locks referenced by an error message are now announced.<br>
      Previously, some error messages only showed the lock addresses.<br>
<br>
    o The message indicating where a lock was first observed now also<br>
      describes the address/location of the lock.<br>
<br>
  - Helgrind now understands the Ada task termination rules and<br>
    creates a happens-before relationship between a terminated task<br>
    and its master.  This avoids some false positives and avoids a big<br>
    memory leak when a lot of Ada tasks are created and terminated.<br>
    The interceptions are only activated with forthcoming releases of<br>
    gnatpro &gt;= 7.3.0w-20140611 and gcc &gt;= 5.0.<br>
<br>
  - A new GDB server monitor command "info locks" giving the list of<br>
    locks, their location, and their status.<br>
<br>
* Callgrind:<br>
<br>
  - callgrind_control now supports the --vgdb-prefix argument,<br>
    which is needed if valgrind was started with this same argument.<br>
<br>
* ==================== OTHER CHANGES ====================<br>
<br>
* Unwinding through inlined function calls.  Stack unwinding can now<br>
  make use of Dwarf3 inlined-unwind information if it is available.<br>
  The practical effect is that inlined calls become visible in stack<br>
  traces.  The suppression matching machinery has been adjusted<br>
  accordingly.  This is controlled by the new option<br>
  --read-inline-info=yes|no.  Currently this is enabled by default<br>
  only on Linux and Android targets and only for the tools Memcheck,<br>
  Helgrind and DRD.<br>
<br>
* Valgrind can now read EXIDX unwind information on 32-bit ARM<br>
  targets.  If an object contains both CFI and EXIDX unwind<br>
  information, Valgrind will prefer the CFI over the EXIDX.  This<br>
  facilitates unwinding through system libraries on arm-android<br>
  targets.<br>
<br>
* Address description logic has been improved and is now common<br>
  between Memcheck and Helgrind, resulting in better address<br>
  descriptions for some kinds of error messages.<br>
<br>
* Error messages about dubious arguments (eg, to malloc or calloc) are<br>
  output like other errors.  This means that they can be suppressed<br>
  and they have a stack trace.<br>
<br>
* The C++ demangler has been updated for better C++11 support.<br>
<br>
* New and modified GDB server monitor features:<br>
<br>
  - Thread local variables/storage (__thread) can now be displayed.<br>
<br>
  - The GDB server monitor command "v.info location &lt;address&gt;"<br>
    displays information about an address.  The information produced<br>
    depends on the tool and on the options given to valgrind.<br>
    Possibly, the following are described: global variables, local<br>
    (stack) variables, allocated or freed blocks, ...<br>
<br>
  - The option "--vgdb-stop-at=event1,event2,..." allows the user to<br>
    ask the GDB server to stop at the start of program execution, at<br>
    the end of the program execution and on Valgrind internal errors.<br>
<br>
  - A new monitor command "v.info stats" shows various Valgrind core<br>
    and tool statistics.<br>
<br>
  - A new monitor command "v.set hostvisibility" allows the GDB server<br>
    to provide access to Valgrind internal host status/memory.<br>
<br>
* A new option "--aspace-minaddr=&lt;address&gt;" can in some situations<br>
  allow the use of more memory by decreasing the address above which<br>
  Valgrind maps memory.  It can also be used to solve address<br>
  conflicts with system libraries by increasing the default value.<br>
  See user manual for details.<br>
<br>
* The amount of memory used by Valgrind to store debug info (unwind<br>
  info, line number information and symbol data) has been<br>
  significantly reduced, even though Valgrind now reads more<br>
  information in order to support unwinding of inlined function calls.<br>
<br>
* Dwarf3 handling with --read-var-info=yes has been improved:<br>
<br>
  - Ada and C struct containing VLAs no longer cause a "bad DIE" error<br>
<br>
  - Code compiled with<br>
    -ffunction-sections -fdata-sections -Wl,--gc-sections<br>
    no longer causes assertion failures.<br>
<br>
* Improved checking for the --sim-hints= and --kernel-variant=<br>
  options.  Unknown strings are now detected and reported to the user<br>
  as a usage error.<br>
<br>
* The semantics of stack start/end boundaries in the valgrind.h<br>
  VALGRIND_STACK_REGISTER client request has been clarified and<br>
  documented.  The convention is that start and end are respectively<br>
  the lowest and highest addressable bytes of the stack.<br>
<br>
* ==================== FIXED BUGS ====================<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (https://bugs.kde.org/enter_bug.cgi?product=valgrind) rather<br>
than mailing the developers (or mailing lists) directly -- bugs that<br>
are not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
  https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
175819  Support for ipv6 socket reporting with --track-fds<br>
232510  make distcheck fails<br>
249435  Analyzing wine programs with callgrind triggers a crash<br>
278972  support for inlined function calls in stacktraces and suppression<br>
        == 199144<br>
291310  FXSAVE instruction marks memory as undefined on amd64<br>
303536  ioctl for SIOCETHTOOL (ethtool(8)) isn't wrapped<br>
308729  vex x86-&gt;IR: unhandled instruction bytes 0xf 0x5 (syscall) <br>
315199  vgcore file for threaded app does not show which thread crashed<br>
315952  tun/tap ioctls are not supported<br>
323178  Unhandled instruction: PLDW register (ARM) <br>
323179  Unhandled instruction: PLDW immediate (ARM)<br>
324050  Helgrind: SEGV because of unaligned stack when using movdqa<br>
325110  Add test-cases for Power ISA 2.06 insns: divdo/divdo. and divduo/divduo.<br>
325124  [MIPSEL] Compilation error<br>
325477  Phase 4 support for IBM Power ISA 2.07<br>
325538  cavium octeon mips64, valgrind reported "dumping core" [...]<br>
325628  Phase 5 support for IBM Power ISA 2.07<br>
325714  Empty vgcore but RLIMIT_CORE is big enough (too big) <br>
325751  Missing the two privileged Power PC Transactional Memory Instructions<br>
325816  Phase 6 support for IBM Power ISA 2.07<br>
325856  Make SGCheck fail gracefully on unsupported platforms<br>
326026  Iop names for count leading zeros/sign bits incorrectly imply [..]<br>
326436  DRD: False positive in libstdc++ std::list::push_back<br>
326444  Cavium MIPS Octeon Specific Load Indexed Instructions<br>
326462  Refactor vgdb to isolate invoker stuff into separate module<br>
326469  amd64-&gt;IR: 0x66 0xF 0x3A 0x63 0xC1 0xE (pcmpistri 0x0E)<br>
326623  DRD: false positive conflict report in a field assignment<br>
326724  Valgrind does not compile on OSX 1.9 Mavericks<br>
326816  Intercept for __strncpy_sse2_unaligned missing?<br>
326921  coregrind fails to compile m_trampoline.S with MIPS/Linux port of V<br>
326983  Clear direction flag after tests on amd64.<br>
327212  Do not prepend the current directory to absolute path names.<br>
327223  Support for Cavium MIPS Octeon Atomic and Count Instructions<br>
327238  Callgrind Assertion 'passed &lt;= last_bb-&gt;cjmp_count' failed<br>
327284  s390x: Fix translation of the risbg instruction<br>
327639  vex amd64-&gt;IR pcmpestri SSE4.2 instruction is unsupported 0x34<br>
327837  dwz compressed alternate .debug_info and .debug_str not read correctly<br>
327916  DW_TAG_typedef may have no name<br>
327943  s390x: add a redirection for the 'index' function<br>
328100  XABORT not implemented<br>
328205  Implement additional Xen hypercalls<br>
328454  add support Backtraces with ARM unwind tables (EXIDX)<br>
328455  s390x: SIGILL after emitting wrong register pair for ldxbr<br>
328711  valgrind.1 manpage "memcheck options" section is badly generated<br>
328878  vex amd64-&gt;IR pcmpestri SSE4.2 instruction is unsupported 0x14<br>
329612  Incorrect handling of AT_BASE for image execution <br>
329694  clang warns about using uninitialized variable <br>
329956  valgrind crashes when lmw/stmw instructions are used on ppc64<br>
330228  mmap must align to VKI_SHMLBA on mips32<br>
330257  LLVM does not support `-mno-dynamic-no-pic` option<br>
330319  amd64-&gt;IR: unhandled instruction bytes: 0xF 0x1 0xD5 (xend)<br>
330459  --track-fds=yes doesn't track eventfds<br>
330469  Add clock_adjtime syscall support<br>
330594  Missing sysalls on PowerPC / uClibc<br>
330622  Add test to regression suite for POWER instruction: dcbzl<br>
330939  Support for AMD's syscall instruction on x86<br>
        == 308729<br>
330941  Typo in PRE(poll) syscall wrapper<br>
331057  unhandled instruction: 0xEEE01B20 (vfma.f64) (has patch)<br>
331254  Fix expected output for memcheck/tests/dw4<br>
331255  Fix race condition in test none/tests/coolo_sigaction<br>
331257  Fix type of jump buffer in test none/tests/faultstatus<br>
331305  configure uses bash specific syntax<br>
331337  s390x WARNING: unhandled syscall: 326 (dup3)<br>
331380  Syscall param timer_create(evp) points to uninitialised byte(s)<br>
331476  Patch to handle ioctl 0x5422 on Linux (x86 and amd64)<br>
331829  Unexpected ioctl opcode sign extension<br>
331830  ppc64: WARNING: unhandled syscall: 96/97<br>
331839  drd/tests/sem_open specifies invalid semaphore name <br>
331847  outcome of drd/tests/thread_name is nondeterministic<br>
332037  Valgrind cannot handle Thumb "add pc, reg"<br>
332055  drd asserts on platforms with VG_STACK_REDZONE_SZB == 0 and<br>
        consistency checks enabled<br>
332263  intercepts for pthread_rwlock_timedrdlock and<br>
        pthread_rwlock_timedwrlock are incorrect<br>
332265  drd could do with post-rwlock_init and pre-rwlock_destroy<br>
        client requests<br>
332276  Implement additional Xen hypercalls<br>
332658  ldrd.w r1, r2, [PC, #imm] does not adjust for 32bit alignment<br>
332765  Fix ms_print to create temporary files in a proper directory<br>
333072  drd: Add semaphore annotations<br>
333145  Tests for missaligned PC+#imm access for arm<br>
333228  AAarch64 Missing instruction encoding: mrs %[reg], ctr_el0<br>
333230  AAarch64 missing instruction encodings: dc, ic, dsb.<br>
333248  WARNING: unhandled syscall: unix:443<br>
333428  ldr.w pc [rD, #imm] instruction leads to assertion<br>
333501  cachegrind: assertion: Cache set count is not a power of two.<br>
        == 336577<br>
        == 292281<br>
333666  Recognize MPX instructions and bnd prefix.<br>
333788  Valgrind does not support the CDROM_DISC_STATUS ioctl (has patch)<br>
333817  Valgrind reports the memory areas written to by the SG_IO<br>
        ioctl as untouched<br>
334049  lzcnt fails silently (x86_32)<br>
334384  Valgrind does not have support Little Endian support for<br>
        IBM POWER PPC 64<br>
334585  recvmmsg unhandled (+patch) (arm)<br>
334705  sendmsg and recvmsg should guard against bogus msghdr fields.<br>
334727  Build fails with -Werror=format-security<br>
334788  clarify doc about --log-file initial program directory<br>
334834  PPC64 Little Endian support, patch 2<br>
334836  PPC64 Little Endian support, patch 3 testcase fixes<br>
334936  patch to fix false positives on alsa SNDRV_CTL_* ioctls<br>
335034  Unhandled ioctl: HCIGETDEVLIST<br>
335155  vgdb, fix error print statement.<br>
335262  arm64: movi 8bit version is not supported<br>
335263  arm64: dmb instruction is not implemented<br>
335441  unhandled ioctl 0x8905 (SIOCATMARK) when running wine under valgrind<br>
335496  arm64: sbc/abc instructions are not implemented<br>
335554  arm64: unhandled instruction: abs<br>
335564  arm64: unhandled instruction: fcvtpu  Xn, Sn<br>
335735  arm64: unhandled instruction: cnt<br>
335736  arm64: unhandled instruction: uaddlv<br>
335848  arm64: unhandled instruction: {s,u}cvtf<br>
335902  arm64: unhandled instruction: sli<br>
335903  arm64: unhandled instruction: umull (vector)<br>
336055  arm64: unhandled instruction: mov (element)<br>
336062  arm64: unhandled instruction: shrn{,2}<br>
336139  mip64: [...] valgrind hangs and spins on a single core [...]<br>
336189  arm64: unhandled Instruction: mvn<br>
336435  Valgrind hangs in pthread_spin_lock consuming 100% CPU<br>
336619  valgrind --read-var-info=yes doesn't handle DW_TAG_restrict_type<br>
336772  Make moans about unknown ioctls more informative<br>
336957  Add a section about the Solaris/illumos port on the webpage<br>
337094  ifunc wrapper is broken on ppc64<br>
337285  fcntl commands F_OFD_SETLK, F_OFD_SETLKW, and F_OFD_GETLK not supported<br>
337528  leak check heuristic for block prefixed by length as 64bit number<br>
337740  Implement additional Xen hypercalls<br>
337762  guest_arm64_toIR.c:4166 (dis_ARM64_load_store): Assertion `0' failed.<br>
337766  arm64-linux: unhandled syscalls mlock (228) and mlockall (230)<br>
337871  deprecate --db-attach<br>
338023  Add support for all V4L2/media ioctls<br>
338024  inlined functions are not shown if DW_AT_ranges is used<br>
338106  Add support for 'kcmp' syscall<br>
338115  DRD: computed conflict set differs from actual after fork<br>
338160  implement display of thread local storage in gdbsrv<br>
338205  configure.ac and check for -Wno-tautological-compare<br>
338300  coredumps are missing one byte of every segment<br>
338445  amd64 vbit-test fails with unknown opcodes used by arm64 VEX<br>
338499  --sim-hints parsing broken due to wrong order in tokens<br>
338615  suppress glibc 2.20 optimized strcmp implementation for ARMv7<br>
338681  Unable to unwind through clone thread created on i386-linux<br>
338698  race condition between gdbsrv and vgdb on startup<br>
338703  helgrind on arm-linux gets false positives in dynamic loader<br>
338791  alt dwz files can be relative of debug/main file<br>
338878  on MacOS: assertion 'VG_IS_PAGE_ALIGNED(clstack_end+1)' failed<br>
338932  build V-trunk with gcc-trunk<br>
338974  glibc 2.20 changed size of struct sigaction sa_flags field on s390<br>
345079  Fix build problems in VEX/useful/test_main.c<br>
n-i-bz  Fix KVM_CREATE_IRQCHIP ioctl handling<br>
n-i-bz  s390x: Fix memory corruption for multithreaded applications<br>
n-i-bz  vex arm-&gt;IR: allow PC as basereg in some LDRD cases<br>
n-i-bz  internal error in Valgrind if vgdb transmit signals when ptrace invoked<br>
n-i-bz  Fix mingw64 support in valgrind.h (dev@, 9 May 2014)<br>
n-i-bz  drd manual: Document how to C++11 programs that use class "std::thread"<br>
n-i-bz  Add command-line option --default-suppressions<br>
n-i-bz  Add support for BLKDISCARDZEROES ioctl<br>
n-i-bz  ppc32/64: fix a regression with the mtfsb0/mtfsb1 instructions<br>
n-i-bz  Add support for	sys_pivot_root and sys_unshare<br>
<br>
(3.10.0.BETA1:  2 September 2014, vex r2940, valgrind r14428)<br>
(3.10.0.BETA2:  8 September 2014, vex r2950, valgrind r14503)<br>
(3.10.0:       10 September 2014, vex r2950, valgrind r14514)<br>
<br>
<br>
<br>
Release 3.9.0 (31 October 2013)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.9.0 is a feature release with many improvements and the usual<br>
collection of bug fixes.<br>
<br>
This release supports X86/Linux, AMD64/Linux, ARM/Linux, PPC32/Linux,<br>
PPC64/Linux, S390X/Linux, MIPS32/Linux, MIPS64/Linux, ARM/Android,<br>
X86/Android, X86/MacOSX 10.7 and AMD64/MacOSX 10.7.  Support for<br>
MacOSX 10.8 is significantly improved relative to the 3.8.0 release.<br>
<br>
* ================== PLATFORM CHANGES =================<br>
<br>
* Support for MIPS64 LE and BE running Linux.  Valgrind has been<br>
  tested on MIPS64 Debian Squeeze and Debian Wheezy distributions.<br>
<br>
* Support for MIPS DSP ASE on MIPS32 platforms.<br>
<br>
* Support for s390x Decimal Floating Point instructions on hosts that<br>
  have the DFP facility installed.<br>
<br>
* Support for POWER8 (Power ISA 2.07) instructions<br>
<br>
* Support for Intel AVX2 instructions.  This is available only on 64<br>
  bit code.<br>
<br>
* Initial support for Intel Transactional Synchronization Extensions,<br>
  both RTM and HLE.<br>
<br>
* Initial support for Hardware Transactional Memory on POWER.<br>
<br>
* Improved support for MacOSX 10.8 (64-bit only).  Memcheck can now<br>
  run large GUI apps tolerably well.<br>
<br>
* ==================== TOOL CHANGES ====================<br>
<br>
* Memcheck:<br>
<br>
  - Improvements in handling of vectorised code, leading to<br>
    significantly fewer false error reports.  You need to use the flag<br>
    --partial-loads-ok=yes to get the benefits of these changes.<br>
<br>
  - Better control over the leak checker.  It is now possible to<br>
    specify which leak kinds (definite/indirect/possible/reachable)<br>
    should be displayed, which should be regarded as errors, and which<br>
    should be suppressed by a given leak suppression.  This is done<br>
    using the options --show-leak-kinds=kind1,kind2,..,<br>
    --errors-for-leak-kinds=kind1,kind2,.. and an optional<br>
    "match-leak-kinds:" line in suppression entries, respectively.<br>
<br>
    Note that generated leak suppressions contain this new line and<br>
    are therefore more specific than in previous releases.  To get the<br>
    same behaviour as previous releases, remove the "match-leak-kinds:"<br>
    line from generated suppressions before using them.<br>
<br>
  - Reduced "possible leak" reports from the leak checker by the use<br>
    of better heuristics.  The available heuristics provide detection<br>
    of valid interior pointers to std::stdstring, to new[] allocated<br>
    arrays with elements having destructors and to interior pointers<br>
    pointing to an inner part of a C++ object using multiple<br>
    inheritance.  They can be selected individually using the<br>
    option --leak-check-heuristics=heur1,heur2,...<br>
<br>
  - Better control of stacktrace acquisition for heap-allocated<br>
    blocks.  Using the --keep-stacktraces option, it is possible to<br>
    control independently whether a stack trace is acquired for each<br>
    allocation and deallocation.  This can be used to create better<br>
    "use after free" errors or to decrease Valgrind's resource<br>
    consumption by recording less information.<br>
<br>
  - Better reporting of leak suppression usage.  The list of used<br>
    suppressions (shown when the -v option is given) now shows, for<br>
    each leak suppressions, how many blocks and bytes it suppressed<br>
    during the last leak search.<br>
<br>
* Helgrind:<br>
<br>
  - False errors resulting from the use of statically initialised<br>
    mutexes and condition variables (PTHREAD_MUTEX_INITIALISER, etc)<br>
    have been removed.<br>
<br>
  - False errors resulting from the use of pthread_cond_waits that<br>
    timeout, have been removed.<br>
<br>
* ==================== OTHER CHANGES ====================<br>
<br>
* Some attempt to tune Valgrind's space requirements to the expected<br>
  capabilities of the target:<br>
<br>
  - The default size of the translation cache has been reduced from 8<br>
    sectors to 6 on Android platforms, since each sector occupies<br>
    about 40MB when using Memcheck.<br>
<br>
  - The default size of the translation cache has been increased to 16<br>
    sectors on all other platforms, reflecting the fact that large<br>
    applications require instrumentation and storage of huge amounts<br>
    of code.  For similar reasons, the number of memory mapped<br>
    segments that can be tracked has been increased by a factor of 6.<br>
<br>
  - In all cases, the maximum number of sectors in the translation<br>
    cache can be controlled by the new flag --num-transtab-sectors.<br>
<br>
* Changes in how debug info (line numbers, etc) is read:<br>
<br>
  - Valgrind no longer temporarily mmaps the entire object to read<br>
    from it.  Instead, reading is done through a small fixed sized<br>
    buffer.  This avoids virtual memory usage spikes when Valgrind<br>
    reads debuginfo from large shared objects.<br>
<br>
  - A new experimental remote debug info server.  Valgrind can read<br>
    debug info from a different machine (typically, a build host)<br>
    where debuginfo objects are stored.  This can save a lot of time<br>
    and hassle when running Valgrind on resource-constrained targets<br>
    (phones, tablets) when the full debuginfo objects are stored<br>
    somewhere else.  This is enabled by the --debuginfo-server=<br>
    option.<br>
<br>
  - Consistency checking between main and debug objects can be<br>
    disabled using the --allow-mismatched-debuginfo option.<br>
<br>
* Stack unwinding by stack scanning, on ARM.  Unwinding by stack<br>
  scanning can recover stack traces in some cases when the normal<br>
  unwind mechanisms fail.  Stack scanning is best described as "a<br>
  nasty, dangerous and misleading hack" and so is disabled by default.<br>
  Use --unw-stack-scan-thresh and --unw-stack-scan-frames to enable<br>
  and control it.<br>
<br>
* Detection and merging of recursive stack frame cycles.  When your<br>
  program has recursive algorithms, this limits the memory used by<br>
  Valgrind for recorded stack traces and avoids recording<br>
  uninteresting repeated calls.  This is controlled by the command<br>
  line option --merge-recursive-frame and by the monitor command<br>
  "v.set merge-recursive-frames".<br>
<br>
* File name and line numbers for used suppressions.  The list of used<br>
  suppressions (shown when the -v option is given) now shows, for each<br>
  used suppression, the file name and line number where the suppression<br>
  is defined.<br>
<br>
* New and modified GDB server monitor features:<br>
<br>
  - valgrind.h has a new client request, VALGRIND_MONITOR_COMMAND,<br>
    that can be used to execute gdbserver monitor commands from the<br>
    client program.<br>
<br>
  - A new monitor command, "v.info open_fds", that gives the list of<br>
    open file descriptors and additional details.<br>
<br>
  - An optional message in the "v.info n_errs_found" monitor command,<br>
    for example "v.info n_errs_found test 1234 finished", allowing a<br>
    comment string to be added to the process output, perhaps for the<br>
    purpose of separating errors of different tests or test phases.<br>
<br>
  - A new monitor command "v.info execontext" that shows information<br>
    about the stack traces recorded by Valgrind.<br>
<br>
  - A new monitor command "v.do expensive_sanity_check_general" to run<br>
    some internal consistency checks.<br>
<br>
* New flag --sigill-diagnostics to control whether a diagnostic<br>
  message is printed when the JIT encounters an instruction it can't<br>
  translate.  The actual behavior -- delivery of SIGILL to the<br>
  application -- is unchanged.<br>
<br>
* The maximum amount of memory that Valgrind can use on 64 bit targets<br>
  has been increased from 32GB to 64GB.  This should make it possible<br>
  to run applications on Memcheck that natively require up to about 35GB.<br>
<br>
* ==================== FIXED BUGS ====================<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (https://bugs.kde.org/enter_bug.cgi?product=valgrind) rather<br>
than mailing the developers (or mailing lists) directly -- bugs that<br>
are not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
  https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
123837  system call: 4th argument is optional, depending on cmd<br>
135425  memcheck should tell you where Freed blocks were Mallocd<br>
164485  VG_N_SEGNAMES and VG_N_SEGMENTS are (still) too small<br>
207815  Adds some of the drm ioctls to syswrap-linux.c <br>
251569  vex amd64-&gt;IR: 0xF 0x1 0xF9 0xBF 0x90 0xD0 0x3 0x0 (RDTSCP)<br>
252955  Impossible to compile with ccache<br>
253519  Memcheck reports auxv pointer accesses as invalid reads.<br>
263034  Crash when loading some PPC64 binaries<br>
269599  Increase deepest backtrace<br>
274695  s390x: Support "compare to/from logical" instructions (z196)<br>
275800  s390x: Autodetect cache info (part 2)<br>
280271  Valgrind reports possible memory leaks on still-reachable std::string<br>
284540  Memcheck shouldn't count suppressions matching still-reachable [..]<br>
289578  Backtraces with ARM unwind tables (stack scan flags)<br>
296311  Wrong stack traces due to -fomit-frame-pointer (x86) <br>
304832  ppc32: build failure<br>
305431  Use find_buildid shdr fallback for separate .debug files<br>
305728  Add support for AVX2 instructions<br>
305948  ppc64: code generation for ShlD64 / ShrD64 asserts<br>
306035  s390x: Fix IR generation for LAAG and friends<br>
306054  s390x: Condition code computation for convert-to-int/logical<br>
306098  s390x: alternate opcode form for convert to/from fixed<br>
306587  Fix cache line detection from auxiliary vector for PPC.<br>
306783  Mips unhandled syscall :  4025  /  4079  / 4182<br>
307038  DWARF2 CFI reader: unhandled DW_OP_ opcode 0x8 (DW_OP_const1u et al)<br>
307082  HG false positive: pthread_cond_destroy: destruction of unknown CV<br>
307101  sys_capget second argument can be NULL<br>
307103  sys_openat: If pathname is absolute, then dirfd is ignored.<br>
307106  amd64-&gt;IR: f0 0f c0 02 (lock xadd byte)<br>
307113  s390x: DFP support<br>
307141  valgrind does't work in mips-linux system<br>
307155  filter_gdb should filter out syscall-template.S T_PSEUDO<br>
307285  x86_amd64 feature test for avx in test suite is wrong<br>
307290  memcheck overlap testcase needs memcpy version filter<br>
307463  Please add "&amp;limit=0" to the "all open bugs" link<br>
307465  --show-possibly-lost=no should reduce the error count / exit code<br>
307557  Leaks on Mac OS X 10.7.5 libraries at ImageLoader::recursiveInit[..]<br>
307729  pkgconfig support broken valgrind.pc<br>
307828  Memcheck false errors SSE optimized wcscpy, wcscmp, wcsrchr, wcschr<br>
307955  Building valgrind 3.7.0-r4 fails in Gentoo AMD64 when using clang<br>
308089  Unhandled syscall on ppc64: prctl<br>
308135  PPC32 MPC8xx has 16 bytes cache size<br>
308321  testsuite memcheck filter interferes with gdb_filter <br>
308333 == 307106<br>
308341  vgdb should report process exit (or fatal signal)<br>
308427  s390 memcheck reports tsearch cjump/cmove depends on uninit<br>
308495  Remove build dependency on installed Xen headers<br>
308573  Internal error on 64-bit instruction executed in 32-bit mode<br>
308626  == 308627<br>
308627  pmovmskb validity bit propagation is imprecise<br>
308644  vgdb command for having the info for the track-fds option<br>
308711  give more info about aspacemgr and arenas in out_of_memory<br>
308717  ARM: implement fixed-point VCVT.F64.[SU]32<br>
308718  ARM implement SMLALBB family of instructions<br>
308886  Missing support for PTRACE_SET/GETREGSET <br>
308930  syscall name_to_handle_at (303 on amd64) not handled<br>
309229  V-bit tester does not report number of tests generated<br>
309323  print unrecognized instuction on MIPS<br>
309425  Provide a --sigill-diagnostics flag to suppress illegal [..]<br>
309427  SSE optimized stpncpy trigger uninitialised value [..] errors<br>
309430  Self hosting ppc64 encounters a vassert error on operand type<br>
309600  valgrind is a bit confused about 0-sized sections<br>
309823  Generate errors for still reachable blocks<br>
309921  PCMPISTRI validity bit propagation is imprecise<br>
309922  none/tests/ppc64/test_dfp5 sometimes fails<br>
310169  The Iop_CmpORD class of Iops is not supported by the vbit checker.<br>
310424  --read-var-info does not properly describe static variables <br>
310792  search additional path for debug symbols<br>
310931  s390x: Message-security assist (MSA) instruction extension [..]<br>
311100  PPC DFP implementation of the integer operands is inconsistent [..]<br>
311318  ARM: "128-bit constant is not implemented" error message<br>
311407  ssse3 bcopy (actually converted memcpy) causes invalid read [..]<br>
311690  V crashes because it redirects branches inside of a redirected function<br>
311880  x86_64: make regtest hangs at shell_valid1<br>
311922  WARNING: unhandled syscall: 170<br>
311933  == 251569<br>
312171  ppc: insn selection for DFP<br>
312571  Rounding mode call wrong for the DFP Iops [..]<br>
312620  Change to Iop_D32toD64 [..] for s390 DFP support broke ppc [..]<br>
312913  Dangling pointers error should also report the alloc stack trace<br>
312980  Building on Mountain Lion generates some compiler warnings<br>
313267  Adding MIPS64/Linux port to Valgrind<br>
313348  == 251569<br>
313354  == 251569<br>
313811  Buffer overflow in assert_fail<br>
314099  coverity pointed out error in VEX guest_ppc_toIR.c insn_suffix<br>
314269  ppc: dead code in insn selection<br>
314718  ARM: implement integer divide instruction (sdiv and udiv)<br>
315345  cl-format.xml and callgrind/dump.c don't agree on using cfl= or cfi=<br>
315441  sendmsg syscall should ignore unset msghdr msg_flags<br>
315534  msgrcv inside a thread causes valgrind to hang (block)<br>
315545  Assertion '(UChar*)sec-&gt;tt[tteNo].tcptr &lt;= (UChar*)hcode' failed<br>
315689  disInstr(thumb): unhandled instruction: 0xF852 0x0E10 (LDRT)<br>
315738  disInstr(arm): unhandled instruction: 0xEEBE0BEE (vcvt.s32.f64)<br>
315959  valgrind man page has bogus SGCHECK (and no BBV) OPTIONS section<br>
316144  valgrind.1 manpage contains unknown ??? strings [..]<br>
316145  callgrind command line options in manpage reference (unknown) [..]<br>
316145  callgrind command line options in manpage reference [..]<br>
316181  drd: Fixed a 4x slowdown for certain applications<br>
316503  Valgrind does not support SSE4 "movntdqa" instruction<br>
316535  Use of |signed int| instead of |size_t| in valgrind messages<br>
316696   fluidanimate program of parsec 2.1 stuck <br>
316761  syscall open_by_handle_at (304 on amd64, 342 on x86) not handled<br>
317091  Use -Wl,-Ttext-segment when static linking if possible [..]<br>
317186  "Impossible happens" when occurs VCVT instruction on ARM<br>
317318  Support for Threading Building Blocks "scalable_malloc"<br>
317444  amd64-&gt;IR: 0xC4 0x41 0x2C 0xC2 0xD2 0x8 (vcmpeq_uqps)<br>
317461  Fix BMI assembler configure check and avx2/bmi/fma vgtest prereqs<br>
317463  bmi testcase IR SANITY CHECK FAILURE<br>
317506  memcheck/tests/vbit-test fails with unknown opcode after [..]<br>
318050  libmpiwrap fails to compile with out-of-source build<br>
318203  setsockopt handling needs to handle SOL_SOCKET/SO_ATTACH_FILTER<br>
318643  annotate_trace_memory tests infinite loop on arm and ppc [..]<br>
318773  amd64-&gt;IR: 0xF3 0x48 0x0F 0xBC 0xC2 0xC3 0x66 0x0F<br>
318929  Crash with: disInstr(thumb): 0xF321 0x0001 (ssat16)<br>
318932  Add missing PPC64 and PPC32 system call support<br>
319235  --db-attach=yes is broken with Yama (ptrace scoping) enabled<br>
319395  Crash with unhandled instruction on STRT (Thumb) instructions<br>
319494  VEX Makefile-gcc standalone build update after r2702<br>
319505  [MIPSEL] Crash: unhandled UNRAY operator.<br>
319858  disInstr(thumb): unhandled instruction on instruction STRBT<br>
319932  disInstr(thumb): unhandled instruction on instruction STRHT<br>
320057  Problems when we try to mmap more than 12 memory pages on MIPS32<br>
320063  Memory from PTRACE_GET_THREAD_AREA is reported uninitialised<br>
320083  disInstr(thumb): unhandled instruction on instruction LDRBT<br>
320116  bind on AF_BLUETOOTH produces warnings because of sockaddr_rc padding<br>
320131  WARNING: unhandled syscall: 369 on ARM (prlimit64)<br>
320211  Stack buffer overflow in ./coregrind/m_main.c with huge TMPDIR<br>
320661  vgModuleLocal_read_elf_debug_info(): "Assertion '!di-&gt;soname'<br>
320895  add fanotify support (patch included)<br>
320998  vex amd64-&gt;IR pcmpestri and pcmpestrm SSE4.2 instruction<br>
321065  Valgrind updates for Xen 4.3<br>
321148  Unhandled instruction: PLI (Thumb 1, 2, 3)<br>
321363  Unhandled instruction: SSAX (ARM + Thumb)<br>
321364  Unhandled instruction: SXTAB16 (ARM + Thumb)<br>
321466  Unhandled instruction: SHASX (ARM + Thumb)<br>
321467  Unhandled instruction: SHSAX (ARM + Thumb)<br>
321468  Unhandled instruction: SHSUB16 (ARM + Thumb)<br>
321619  Unhandled instruction: SHSUB8 (ARM + Thumb)<br>
321620  Unhandled instruction: UASX (ARM + Thumb)<br>
321621  Unhandled instruction: USAX (ARM + Thumb)<br>
321692  Unhandled instruction: UQADD16 (ARM + Thumb)<br>
321693  Unhandled instruction: LDRSBT (Thumb)<br>
321694  Unhandled instruction: UQASX (ARM + Thumb)<br>
321696  Unhandled instruction: UQSAX (Thumb + ARM)<br>
321697  Unhandled instruction: UHASX (ARM + Thumb)<br>
321703  Unhandled instruction: UHSAX (ARM + Thumb)<br>
321704  Unhandled instruction: REVSH (ARM + Thumb)<br>
321730  Add cg_diff and cg_merge man pages<br>
321738  Add vgdb and valgrind-listener man pages<br>
321814  == 315545<br>
321891  Unhandled instruction: LDRHT (Thumb)<br>
321960  pthread_create() then alloca() causing invalid stack write errors<br>
321969  ppc32 and ppc64 don't support [lf]setxattr<br>
322254  Show threadname together with tid if set by application<br>
322294  Add initial support for IBM Power ISA 2.07<br>
322368  Assertion failure in wqthread_hijack under OS X 10.8<br>
322563  vex mips-&gt;IR: 0x70 0x83 0xF0 0x3A<br>
322807  VALGRIND_PRINTF_BACKTRACE writes callstack to xml and text to stderr<br>
322851  0bXXX binary literal syntax is not standard <br>
323035  Unhandled instruction: LDRSHT(Thumb)<br>
323036  Unhandled instruction: SMMLS (ARM and Thumb)<br>
323116  The memcheck/tests/ppc64/power_ISA2_05.c fails to build [..]<br>
323175  Unhandled instruction: SMLALD (ARM + Thumb)<br>
323177  Unhandled instruction: SMLSLD (ARM + Thumb)<br>
323432  Calling pthread_cond_destroy() or pthread_mutex_destroy() [..]<br>
323437  Phase 2 support for IBM Power ISA 2.07<br>
323713  Support mmxext (integer sse) subset on i386 (athlon)<br>
323803  Transactional memory instructions are not supported for Power<br>
323893  SSE3 not available on amd cpus in valgrind<br>
323905  Probable false positive from Valgrind/drd on close()<br>
323912  valgrind.h header isn't compatible for mingw64<br>
324047  Valgrind doesn't support [LDR,ST]{S}[B,H]T ARM instructions<br>
324149  helgrind: When pthread_cond_timedwait returns ETIMEDOUT [..]<br>
324181  mmap does not handle MAP_32BIT<br>
324227  memcheck false positive leak when a thread calls exit+block [..]<br>
324421  Support for fanotify API on ARM architecture<br>
324514  gdbserver monitor cmd output behaviour consistency [..]<br>
324518  ppc64: Emulation of dcbt instructions does not handle [..]<br>
324546  none/tests/ppc32 test_isa_2_07_part2 requests -m64<br>
324582  When access is made to freed memory, report both allocation [..]<br>
324594  Fix overflow computation for Power ISA 2.06 insns: mulldo/mulldo.<br>
324765  ppc64: illegal instruction when executing none/tests/ppc64/jm-misc<br>
324816  Incorrect VEX implementation for xscvspdp/xvcvspdp for SNaN inputs<br>
324834  Unhandled instructions in Microsoft C run-time for x86_64<br>
324894  Phase 3 support for IBM Power ISA 2.07<br>
326091  drd: Avoid false race reports from optimized strlen() impls<br>
326113  valgrind libvex hwcaps error on AMD64 <br>
n-i-bz  Some wrong command line options could be ignored<br>
n-i-bz  patch to allow fair-sched on android<br>
n-i-bz  report error for vgdb snapshot requested before execution<br>
n-i-bz  same as 303624 (fixed in 3.8.0), but for x86 android<br>
<br>
(3.9.0: 31 October 2013, vex r2796, valgrind r13708)<br>
<br>
<br>
<br>
Release 3.8.1 (19 September 2012)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.8.1 is a bug fix release.  It fixes some assertion failures in 3.8.0<br>
that occur moderately frequently in real use cases, adds support for<br>
some missing instructions on ARM, and fixes a deadlock condition on<br>
MacOSX.  If you package or deliver 3.8.0 for others to use, you might<br>
want to consider upgrading to 3.8.1 instead.<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (https://bugs.kde.org/enter_bug.cgi?product=valgrind) rather<br>
than mailing the developers (or mailing lists) directly -- bugs that<br>
are not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
  https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
284004  == 301281<br>
289584  Unhandled instruction: 0xF 0x29 0xE5 (MOVAPS)<br>
295808  amd64-&gt;IR: 0xF3 0xF 0xBC 0xC0 (TZCNT)<br>
298281  wcslen causes false(?) uninitialised value warnings<br>
301281  valgrind hangs on OS X when the process calls system()<br>
304035  disInstr(arm): unhandled instruction 0xE1023053<br>
304867  implement MOVBE instruction in x86 mode<br>
304980  Assertion 'lo &lt;= hi' failed in vgModuleLocal_find_rx_mapping<br>
305042  amd64: implement 0F 7F encoding of movq between two registers<br>
305199  ARM: implement QDADD and QDSUB<br>
305321  amd64-&gt;IR: 0xF 0xD 0xC (prefetchw)<br>
305513  killed by fatal signal: SIGSEGV<br>
305690  DRD reporting invalid semaphore when sem_trywait fails<br>
305926  Invalid alignment checks for some AVX instructions<br>
306297  disInstr(thumb): unhandled instruction 0xE883 0x000C<br>
306310  3.8.0 release tarball missing some files<br>
306612  RHEL 6 glibc-2.X default suppressions need /lib*/libc-*patterns<br>
306664  vex amd64-&gt;IR: 0x66 0xF 0x3A 0x62 0xD1 0x46 0x66 0xF<br>
n-i-bz  shmat of a segment &gt; 4Gb does not work <br>
n-i-bz  simulate_control_c script wrong USR1 signal number on mips<br>
n-i-bz  vgdb ptrace calls wrong on mips [...]<br>
n-i-bz  Fixes for more MPI false positives<br>
n-i-bz  exp-sgcheck's memcpy causes programs to segfault<br>
n-i-bz  OSX build w/ clang: asserts at startup<br>
n-i-bz  Incorrect undef'dness prop for Iop_DPBtoBCD and Iop_BCDtoDPB<br>
n-i-bz  fix a couple of union tag-vs-field mixups<br>
n-i-bz  OSX: use __NR_poll_nocancel rather than __NR_poll<br>
<br>
The following bugs were fixed in 3.8.0 but not listed in this NEWS<br>
file at the time:<br>
<br>
254088  Valgrind should know about UD2 instruction<br>
301280  == 254088<br>
301902  == 254088<br>
304754  NEWS blows TeX's little mind<br>
<br>
(3.8.1: 19 September 2012, vex r2537, valgrind r12996)<br>
<br>
<br>
<br>
Release 3.8.0 (10 August 2012)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.8.0 is a feature release with many improvements and the usual<br>
collection of bug fixes.<br>
<br>
This release supports X86/Linux, AMD64/Linux, ARM/Linux, PPC32/Linux,<br>
PPC64/Linux, S390X/Linux, MIPS/Linux, ARM/Android, X86/Android,<br>
X86/MacOSX 10.6/10.7 and AMD64/MacOSX 10.6/10.7.  Support for recent<br>
distros and toolchain components (glibc 2.16, gcc 4.7) has been added.<br>
There is initial support for MacOSX 10.8, but it is not usable for<br>
serious work at present.<br>
<br>
* ================== PLATFORM CHANGES =================<br>
<br>
* Support for MIPS32 platforms running Linux.  Valgrind has been<br>
  tested on MIPS32 and MIPS32r2 platforms running different Debian<br>
  Squeeze and MeeGo distributions.  Both little-endian and big-endian<br>
  cores are supported.  The tools Memcheck, Massif and Lackey have<br>
  been tested and are known to work. See README.mips for more details.<br>
<br>
* Preliminary support for Android running on x86.<br>
<br>
* Preliminary (as-yet largely unusable) support for MacOSX 10.8.<br>
<br>
* Support for Intel AVX instructions and for AES instructions.  This<br>
  support is available only for 64 bit code.<br>
<br>
* Support for POWER Decimal Floating Point instructions.<br>
<br>
* ==================== TOOL CHANGES ====================<br>
<br>
* Non-libc malloc implementations are now supported.  This is useful<br>
  for tools that replace malloc (Memcheck, Massif, DRD, Helgrind).<br>
  Using the new option --soname-synonyms, such tools can be informed<br>
  that the malloc implementation is either linked statically into the<br>
  executable, or is present in some other shared library different<br>
  from libc.so.  This makes it possible to process statically linked<br>
  programs, and programs using other malloc libraries, for example<br>
  TCMalloc or JEMalloc.<br>
<br>
* For tools that provide their own replacement for malloc et al, the<br>
  option --redzone-size=&lt;number&gt; allows users to specify the size of<br>
  the padding blocks (redzones) added before and after each client<br>
  allocated block.  Smaller redzones decrease the memory needed by<br>
  Valgrind.  Bigger redzones increase the chance to detect blocks<br>
  overrun or underrun.  Prior to this change, the redzone size was<br>
  hardwired to 16 bytes in Memcheck.<br>
<br>
* Memcheck:<br>
<br>
  - The leak_check GDB server monitor command now can<br>
    control the maximum nr of loss records to output.<br>
<br>
  - Reduction of memory use for applications allocating<br>
    many blocks and/or having many partially defined bytes.<br>
<br>
  - Addition of GDB server monitor command 'block_list' that lists<br>
    the addresses/sizes of the blocks of a leak search loss record.<br>
<br>
  - Addition of GDB server monitor command 'who_points_at' that lists<br>
    the locations pointing at a block.<br>
<br>
  - If a redzone size &gt; 0 is given, VALGRIND_MALLOCLIKE_BLOCK now will<br>
    detect an invalid access of these redzones, by marking them<br>
    noaccess.  Similarly, if a redzone size is given for a memory<br>
    pool, VALGRIND_MEMPOOL_ALLOC will mark the redzones no access.<br>
    This still allows to find some bugs if the user has forgotten to<br>
    mark the pool superblock noaccess.<br>
<br>
  - Performance of memory leak check has been improved, especially in<br>
    cases where there are many leaked blocks and/or many suppression<br>
    rules used to suppress leak reports.<br>
<br>
  - Reduced noise (false positive) level on MacOSX 10.6/10.7, due to<br>
    more precise analysis, which is important for LLVM/Clang<br>
    generated code.  This is at the cost of somewhat reduced<br>
    performance.  Note there is no change to analysis precision or<br>
    costs on Linux targets.<br>
<br>
* DRD:<br>
<br>
  - Added even more facilities that can help finding the cause of a data<br>
    race, namely the command-line option --ptrace-addr and the macro<br>
    DRD_STOP_TRACING_VAR(x). More information can be found in the manual.<br>
<br>
  - Fixed a subtle bug that could cause false positive data race reports.<br>
<br>
* ==================== OTHER CHANGES ====================<br>
<br>
* The C++ demangler has been updated so as to work well with C++ <br>
  compiled by up to at least g++ 4.6.<br>
<br>
* Tool developers can make replacement/wrapping more flexible thanks<br>
  to the new option --soname-synonyms.  This was reported above, but<br>
  in fact is very general and applies to all function<br>
  replacement/wrapping, not just to malloc-family functions.<br>
<br>
* Round-robin scheduling of threads can be selected, using the new<br>
  option --fair-sched= yes.  Prior to this change, the pipe-based<br>
  thread serialisation mechanism (which is still the default) could<br>
  give very unfair scheduling.  --fair-sched=yes improves<br>
  responsiveness of interactive multithreaded applications, and<br>
  improves repeatability of results from the thread checkers Helgrind<br>
  and DRD.<br>
<br>
* For tool developers: support to run Valgrind on Valgrind has been<br>
  improved.  We can now routinely Valgrind on Helgrind or Memcheck.<br>
<br>
* gdbserver now shows the float shadow registers as integer<br>
  rather than float values, as the shadow values are mostly<br>
  used as bit patterns.<br>
<br>
* Increased limit for the --num-callers command line flag to 500.<br>
<br>
* Performance improvements for error matching when there are many<br>
  suppression records in use.<br>
<br>
* Improved support for DWARF4 debugging information (bug 284184).<br>
<br>
* Initial support for DWZ compressed Dwarf debug info.<br>
<br>
* Improved control over the IR optimiser's handling of the tradeoff<br>
  between performance and precision of exceptions.  Specifically,<br>
  --vex-iropt-precise-memory-exns has been removed and replaced by<br>
  --vex-iropt-register-updates, with extended functionality.  This<br>
  allows the Valgrind gdbserver to always show up to date register<br>
  values to GDB.<br>
<br>
* Modest performance gains through the use of translation chaining for<br>
  JIT-generated code.<br>
<br>
* ==================== FIXED BUGS ====================<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (https://bugs.kde.org/enter_bug.cgi?product=valgrind) rather<br>
than mailing the developers (or mailing lists) directly -- bugs that<br>
are not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
  https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
197914  Building valgrind from svn now requires automake-1.10<br>
203877  increase to 16Mb maximum allowed alignment for memalign et al<br>
219156  Handle statically linked malloc or other malloc lib (e.g. tcmalloc) <br>
247386  make perf does not run all performance tests<br>
270006  Valgrind scheduler unfair <br>
270777  Adding MIPS/Linux port to Valgrind<br>
270796  s390x: Removed broken support for the TS insn<br>
271438  Fix configure for proper SSE4.2 detection<br>
273114  s390x: Support TR, TRE, TROO, TROT, TRTO, and TRTT instructions<br>
273475  Add support for AVX instructions<br>
274078  improved configure logic for mpicc<br>
276993  fix mremap 'no thrash checks' <br>
278313  Fedora 15/x64: err read debug info with --read-var-info=yes flag<br>
281482  memcheck incorrect byte allocation count in realloc() for silly argument<br>
282230  group allocator for small fixed size, use it for MC_Chunk/SEc vbit<br>
283413  Fix wrong sanity check<br>
283671  Robustize alignment computation in LibVEX_Alloc<br>
283961  Adding support for some HCI IOCTLs<br>
284124  parse_type_DIE: confused by: DWARF 4<br>
284864  == 273475 (Add support for AVX instructions)<br>
285219  Too-restrictive constraints for Thumb2 "SP plus/minus register"<br>
285662  (MacOSX): Memcheck needs to replace memcpy/memmove<br>
285725  == 273475 (Add support for AVX instructions)<br>
286261  add wrapper for linux I2C_RDWR ioctl<br>
286270  vgpreload is not friendly to 64-&gt;32 bit execs, gives ld.so warnings<br>
286374  Running cachegrind with --branch-sim=yes on 64-bit PowerPC program fails<br>
286384  configure fails "checking for a supported version of gcc"<br>
286497  == 273475 (Add support for AVX instructions)<br>
286596  == 273475 (Add support for AVX instructions)<br>
286917  disInstr(arm): unhandled instruction: QADD (also QSUB)<br>
287175  ARM: scalar VFP fixed-point VCVT instructions not handled<br>
287260  Incorrect conditional jump or move depends on uninitialised value(s)<br>
287301  vex amd64-&gt;IR: 0x66 0xF 0x38 0x41 0xC0 0xB8 0x0 0x0 (PHMINPOSUW)<br>
287307  == 273475 (Add support for AVX instructions)<br>
287858  VG_(strerror): unknown error <br>
288298  (MacOSX) unhandled syscall shm_unlink<br>
288995  == 273475 (Add support for AVX instructions)<br>
289470  Loading of large Mach-O thin binaries fails.<br>
289656  == 273475 (Add support for AVX instructions)<br>
289699  vgdb connection in relay mode erroneously closed due to buffer overrun <br>
289823  ==  293754 (PCMPxSTRx not implemented for 16-bit characters)<br>
289839  s390x: Provide support for unicode conversion instructions<br>
289939  monitor cmd 'leak_check' with details about leaked or reachable blocks<br>
290006  memcheck doesn't mark %xmm as initialized after "pcmpeqw %xmm %xmm"<br>
290655  Add support for AESKEYGENASSIST instruction <br>
290719  valgrind-3.7.0 fails with automake-1.11.2 due to"pkglibdir" usage<br>
290974  vgdb must align pages to VKI_SHMLBA (16KB) on ARM <br>
291253  ES register not initialised in valgrind simulation<br>
291568  Fix 3DNOW-related crashes with baseline x86_64 CPU (w patch)<br>
291865  s390x: Support the "Compare Double and Swap" family of instructions<br>
292300  == 273475 (Add support for AVX instructions)<br>
292430  unrecognized instruction in __intel_get_new_mem_ops_cpuid<br>
292493  == 273475 (Add support for AVX instructions)<br>
292626  Missing fcntl F_SETOWN_EX and F_GETOWN_EX support<br>
292627  Missing support for some SCSI ioctls<br>
292628  none/tests/x86/bug125959-x86.c triggers undefined behavior<br>
292841  == 273475 (Add support for AVX instructions)<br>
292993  implement the getcpu syscall on amd64-linux<br>
292995  Implement the &#8220;cross memory attach&#8221; syscalls introduced in Linux 3.2<br>
293088  Add some VEX sanity checks for ppc64 unhandled instructions<br>
293751  == 290655 (Add support for AESKEYGENASSIST instruction)<br>
293754  PCMPxSTRx not implemented for 16-bit characters<br>
293755  == 293754 (No tests for PCMPxSTRx on 16-bit characters)<br>
293808  CLFLUSH not supported by latest VEX for amd64<br>
294047  valgrind does not correctly emulate prlimit64(..., RLIMIT_NOFILE, ...)<br>
294048  MPSADBW instruction not implemented<br>
294055  regtest none/tests/shell fails when locale is not set to C<br>
294185  INT 0x44 (and others) not supported on x86 guest, but used by Jikes RVM<br>
294190  --vgdb-error=xxx can be out of sync with errors shown to the user<br>
294191  amd64: fnsave/frstor and 0x66 size prefixes on FP instructions<br>
294260  disInstr_AMD64: disInstr miscalculated next %rip<br>
294523  --partial-loads-ok=yes causes false negatives<br>
294617  vex amd64-&gt;IR: 0x66 0xF 0x3A 0xDF 0xD1 0x1 0xE8 0x6A<br>
294736  vex amd64-&gt;IR: 0x48 0xF 0xD7 0xD6 0x48 0x83<br>
294812  patch allowing to run (on x86 at least) helgrind/drd on tool.<br>
295089  can not annotate source for both helgrind and drd<br>
295221  POWER Processor decimal floating point instruction support missing<br>
295427  building for i386 with clang on darwin11 requires "-new_linker linker"<br>
295428  coregrind/m_main.c has incorrect x86 assembly for darwin<br>
295590  Helgrind: Assertion 'cvi-&gt;nWaiters &gt; 0' failed<br>
295617  ARM - Add some missing syscalls<br>
295799  Missing \n with get_vbits in gdbserver when line is % 80 [...]<br>
296229  Linux user input device ioctls missing wrappers<br>
296318  ELF Debug info improvements (more than one rx/rw mapping)<br>
296422  Add translation chaining support<br>
296457  vex amd64-&gt;IR: 0x66 0xF 0x3A 0xDF 0xD1 0x1 0xE8 0x6A (dup of AES)<br>
296792  valgrind 3.7.0: add SIOCSHWTSTAMP (0x89B0) ioctl wrapper<br>
296983  Fix build issues on x86_64/ppc64 without 32-bit toolchains<br>
297078  gdbserver signal handling problems [..]<br>
297147  drd false positives on newly allocated memory<br>
297329  disallow decoding of IBM Power DFP insns on some machines<br>
297497  POWER Processor decimal floating point instruction support missing<br>
297701  Another alias for strncasecmp_l in libc-2.13.so<br>
297911  'invalid write' not reported when using APIs for custom mem allocators.<br>
297976  s390x: revisit EX implementation<br>
297991  Valgrind interferes with mmap()+ftell() <br>
297992  Support systems missing WIFCONTINUED (e.g. pre-2.6.10 Linux) <br>
297993  Fix compilation of valgrind with gcc -g3.<br>
298080  POWER Processor DFP support missing, part 3<br>
298227  == 273475 (Add support for AVX instructions)<br>
298335  == 273475 (Add support for AVX instructions)<br>
298354  Unhandled ARM Thumb instruction 0xEB0D 0x0585 (streq)<br>
298394  s390x: Don't bail out on an unknown machine model.  [..]<br>
298421  accept4() syscall (366) support is missing for ARM<br>
298718  vex amd64-&gt;IR: 0xF 0xB1 0xCB 0x9C 0x8F 0x45<br>
298732  valgrind installation problem in ubuntu with kernel version 3.x<br>
298862  POWER Processor DFP instruction support missing, part 4<br>
298864  DWARF reader mis-parses DW_FORM_ref_addr<br>
298943  massif asserts with --pages-as-heap=yes when brk is changing [..]<br>
299053  Support DWARF4 DW_AT_high_pc constant form<br>
299104  == 273475 (Add support for AVX instructions)<br>
299316  Helgrind: hg_main.c:628 (map_threads_lookup): Assertion 'thr' failed.<br>
299629  dup3() syscall (358) support is missing for ARM<br>
299694  POWER Processor DFP instruction support missing, part 5<br>
299756  Ignore --free-fill for MEMPOOL_FREE and FREELIKE client requests<br>
299803  == 273475 (Add support for AVX instructions)<br>
299804  == 273475 (Add support for AVX instructions)<br>
299805  == 273475 (Add support for AVX instructions)<br>
300140  ARM - Missing (T1) SMMUL<br>
300195  == 296318 (ELF Debug info improvements (more than one rx/rw mapping))<br>
300389  Assertion `are_valid_hwcaps(VexArchAMD64, [..])' failed.<br>
300414  FCOM and FCOMP unimplemented for amd64 guest<br>
301204  infinite loop in canonicaliseSymtab with ifunc symbol<br>
301229  == 203877 (increase to 16Mb maximum allowed alignment for memalign etc)<br>
301265  add x86 support to Android build <br>
301984  configure script doesn't detect certain versions of clang<br>
302205  Fix compiler warnings for POWER VEX code and POWER test cases<br>
302287  Unhandled movbe instruction on Atom processors<br>
302370  PPC: fnmadd, fnmsub, fnmadds, fnmsubs insns always negate the result<br>
302536  Fix for the POWER Valgrind regression test: memcheck-ISA2.0.<br>
302578  Unrecognized isntruction 0xc5 0x32 0xc2 0xca 0x09 vcmpngess<br>
302656  == 273475 (Add support for AVX instructions)<br>
302709  valgrind for ARM needs extra tls support for android emulator [..]<br>
302827  add wrapper for CDROM_GET_CAPABILITY<br>
302901  Valgrind crashes with dwz optimized debuginfo<br>
302918  Enable testing of the vmaddfp and vnsubfp instructions in the testsuite<br>
303116  Add support for the POWER instruction popcntb<br>
303127  Power test suite fixes for frsqrte, vrefp, and vrsqrtefp instructions.<br>
303250  Assertion `instrs_in-&gt;arr_used &lt;= 10000' failed w/ OpenSSL code<br>
303466  == 273475 (Add support for AVX instructions)<br>
303624  segmentation fault on Android 4.1 (e.g. on Galaxy Nexus OMAP) <br>
303963  strstr() function produces wrong results under valgrind callgrind<br>
304054  CALL_FN_xx macros need to enforce stack alignment<br>
304561  tee system call not supported<br>
715750  (MacOSX): Incorrect invalid-address errors near 0xFFFFxxxx (mozbug#)<br>
n-i-bz  Add missing gdbserver xml files for shadow registers for ppc32<br>
n-i-bz  Bypass gcc4.4/4.5 code gen bugs causing out of memory or asserts<br>
n-i-bz  Fix assert in gdbserver for watchpoints watching the same address<br>
n-i-bz  Fix false positive in sys_clone on amd64 when optional args [..]<br>
n-i-bz  s390x: Shadow registers can now be examined using vgdb<br>
<br>
(3.8.0-TEST3:  9 August 2012, vex r2465, valgrind r12865)<br>
(3.8.0:       10 August 2012, vex r2465, valgrind r12866)<br>
<br>
<br>
<br>
Release 3.7.0 (5 November 2011)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.7.0 is a feature release with many significant improvements and the<br>
usual collection of bug fixes.<br>
<br>
This release supports X86/Linux, AMD64/Linux, ARM/Linux, PPC32/Linux,<br>
PPC64/Linux, S390X/Linux, ARM/Android, X86/Darwin and AMD64/Darwin.<br>
Support for recent distros and toolchain components (glibc 2.14, gcc<br>
4.6, MacOSX 10.7) has been added.<br>
<br>
* ================== PLATFORM CHANGES =================<br>
<br>
* Support for IBM z/Architecture (s390x) running Linux.  Valgrind can<br>
  analyse 64-bit programs running on z/Architecture.  Most user space<br>
  instructions up to and including z10 are supported.  Valgrind has<br>
  been tested extensively on z9, z10, and z196 machines running SLES<br>
  10/11, RedHat 5/6m, and Fedora. The Memcheck and Massif tools are<br>
  known to work well. Callgrind, Helgrind, and DRD work reasonably<br>
  well on z9 and later models. See README.s390 for more details.<br>
<br>
* Preliminary support for MacOSX 10.7 and XCode 4.  Both 32- and<br>
  64-bit processes are supported.  Some complex threaded applications<br>
  (Firefox) are observed to hang when run as 32 bit applications,<br>
  whereas 64-bit versions run OK.  The cause is unknown.  Memcheck<br>
  will likely report some false errors.  In general, expect some rough<br>
  spots.  This release also supports MacOSX 10.6, but drops support<br>
  for 10.5.<br>
<br>
* Preliminary support for Android (on ARM).  Valgrind can now run<br>
  large applications (eg, Firefox) on (eg) a Samsung Nexus S.  See<br>
  README.android for more details, plus instructions on how to get<br>
  started.<br>
<br>
* Support for the IBM Power ISA 2.06 (Power7 instructions)<br>
<br>
* General correctness and performance improvements for ARM/Linux, and,<br>
  by extension, ARM/Android.<br>
<br>
* Further solidification of support for SSE 4.2 in 64-bit mode.  AVX<br>
  instruction set support is under development but is not available in<br>
  this release.<br>
<br>
* Support for AIX5 has been removed.<br>
<br>
* ==================== TOOL CHANGES ====================<br>
<br>
* Memcheck: some incremental changes:<br>
<br>
  - reduction of memory use in some circumstances<br>
<br>
  - improved handling of freed memory, which in some circumstances <br>
    can cause detection of use-after-free that would previously have<br>
    been missed<br>
<br>
  - fix of a longstanding bug that could cause false negatives (missed<br>
    errors) in programs doing vector saturated narrowing instructions.<br>
<br>
* Helgrind: performance improvements and major memory use reductions,<br>
  particularly for large, long running applications which perform many<br>
  synchronisation (lock, unlock, etc) events.  Plus many smaller<br>
  changes:<br>
<br>
  - display of locksets for both threads involved in a race<br>
<br>
  - general improvements in formatting/clarity of error messages<br>
<br>
  - addition of facilities and documentation regarding annotation<br>
    of thread safe reference counted C++ classes<br>
<br>
  - new flag --check-stack-refs=no|yes [yes], to disable race checking<br>
    on thread stacks (a performance hack)<br>
<br>
  - new flag --free-is-write=no|yes [no], to enable detection of races<br>
    where one thread accesses heap memory but another one frees it,<br>
    without any coordinating synchronisation event<br>
<br>
* DRD: enabled XML output; added support for delayed thread deletion<br>
  in order to detect races that occur close to the end of a thread<br>
  (--join-list-vol); fixed a memory leak triggered by repeated client<br>
  memory allocatation and deallocation; improved Darwin support.<br>
<br>
* exp-ptrcheck: this tool has been renamed to exp-sgcheck<br>
<br>
* exp-sgcheck: this tool has been reduced in scope so as to improve<br>
  performance and remove checking that Memcheck does better.<br>
  Specifically, the ability to check for overruns for stack and global<br>
  arrays is unchanged, but the ability to check for overruns of heap<br>
  blocks has been removed.  The tool has accordingly been renamed to<br>
  exp-sgcheck ("Stack and Global Array Checking").<br>
<br>
* ==================== OTHER CHANGES ====================<br>
<br>
* GDB server: Valgrind now has an embedded GDB server.  That means it<br>
  is possible to control a Valgrind run from GDB, doing all the usual<br>
  things that GDB can do (single stepping, breakpoints, examining<br>
  data, etc).  Tool-specific functionality is also available.  For<br>
  example, it is possible to query the definedness state of variables<br>
  or memory from within GDB when running Memcheck; arbitrarily large<br>
  memory watchpoints are supported, etc.  To use the GDB server, start<br>
  Valgrind with the flag --vgdb-error=0 and follow the on-screen<br>
  instructions.<br>
<br>
* Improved support for unfriendly self-modifying code: a new option<br>
  --smc-check=all-non-file is available.  This adds the relevant<br>
  consistency checks only to code that originates in non-file-backed<br>
  mappings.  In effect this confines the consistency checking only to<br>
  code that is or might be JIT generated, and avoids checks on code<br>
  that must have been compiled ahead of time.  This significantly<br>
  improves performance on applications that generate code at run time.<br>
<br>
* It is now possible to build a working Valgrind using Clang-2.9 on<br>
  Linux.<br>
<br>
* new client requests VALGRIND_{DISABLE,ENABLE}_ERROR_REPORTING.<br>
  These enable and disable error reporting on a per-thread, and<br>
  nestable, basis.  This is useful for hiding errors in particularly<br>
  troublesome pieces of code.  The MPI wrapper library (libmpiwrap.c)<br>
  now uses this facility.<br>
<br>
* Added the --mod-funcname option to cg_diff.<br>
<br>
* ==================== FIXED BUGS ====================<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (http://bugs.kde.org/enter_valgrind_bug.cgi) rather than<br>
mailing the developers (or mailing lists) directly -- bugs that are<br>
not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
 79311  malloc silly arg warning does not give stack trace<br>
210935  port valgrind.h (not valgrind) to win32 to support client requests<br>
214223  valgrind SIGSEGV on startup gcc 4.4.1 ppc32 (G4) Ubuntu 9.10<br>
243404  Port to zSeries<br>
243935  Helgrind: incorrect handling of ANNOTATE_HAPPENS_BEFORE()/AFTER()<br>
247223  non-x86: Suppress warning: 'regparm' attribute directive ignored<br>
250101  huge "free" memory usage due to m_mallocfree.c fragmentation<br>
253206  Some fixes for the faultstatus testcase<br>
255223  capget testcase fails when running as root<br>
256703  xlc_dbl_u32.c testcase broken<br>
256726  Helgrind tests have broken inline asm <br>
259977  == 214223 (Valgrind segfaults doing __builtin_longjmp)<br>
264800  testcase compile failure on zseries<br>
265762  make public VEX headers compilable by G++ 3.x<br>
265771  assertion in jumps.c (r11523) fails with glibc-2.3<br>
266753  configure script does not give the user the option to not use QtCore<br>
266931  gen_insn_test.pl is broken<br>
266961  ld-linux.so.2 i?86-linux strlen issues<br>
266990  setns instruction causes false positive<br>
267020  Make directory for temporary files configurable at run-time.<br>
267342  == 267997 (segmentation fault on Mac OS 10.6)<br>
267383  Assertion 'vgPlain_strlen(dir) + vgPlain_strlen(file) + 1 &lt; 256' failed<br>
267413  Assertion 'DRD_(g_threadinfo)[tid].synchr_nesting &gt;= 1' failed.<br>
267488  regtest: darwin support for 64-bit build<br>
267552  SIGSEGV (misaligned_stack_error) with DRD, but not with other tools<br>
267630  Add support for IBM Power ISA 2.06 -- stage 1<br>
267769  == 267997 (Darwin: memcheck triggers segmentation fault)<br>
267819  Add client request for informing the core about reallocation<br>
267925  laog data structure quadratic for a single sequence of lock<br>
267968  drd: (vgDrd_thread_set_joinable): Assertion '0 &lt;= (int)tid ..' failed<br>
267997  MacOSX: 64-bit V segfaults on launch when built with Xcode 4.0.1<br>
268513  missed optimizations in fold_Expr<br>
268619  s390x: fpr - gpr transfer facility <br>
268620  s390x: reconsider "long displacement" requirement <br>
268621  s390x: improve IR generation for XC<br>
268715  s390x: FLOGR is not universally available<br>
268792  == 267997 (valgrind seg faults on startup when compiled with Xcode 4)<br>
268930  s390x: MHY is not universally available<br>
269078  arm-&gt;IR: unhandled instruction SUB (SP minus immediate/register) <br>
269079  Support ptrace system call on ARM<br>
269144  missing "Bad option" error message<br>
269209  conditional load and store facility (z196)<br>
269354  Shift by zero on x86 can incorrectly clobber CC_NDEP<br>
269641  == 267997 (valgrind segfaults immediately (segmentation fault))<br>
269736  s390x: minor code generation tweaks<br>
269778  == 272986 (valgrind.h: swap roles of VALGRIND_DO_CLIENT_REQUEST() ..)<br>
269863  s390x: remove unused function parameters<br>
269864  s390x: tweak s390_emit_load_cc <br>
269884  == 250101 (overhead for huge blocks exhausts space too soon)<br>
270082  s390x: Make sure to point the PSW address to the next address on SIGILL<br>
270115  s390x: rewrite some testcases<br>
270309  == 267997 (valgrind crash on startup)<br>
270320  add support for Linux FIOQSIZE ioctl() call<br>
270326  segfault while trying to sanitize the environment passed to execle<br>
270794  IBM POWER7 support patch causes regression in none/tests<br>
270851  IBM POWER7 fcfidus instruction causes memcheck to fail<br>
270856  IBM POWER7 xsnmaddadp instruction causes memcheck to fail on 32bit app <br>
270925  hyper-optimized strspn() in /lib64/libc-2.13.so needs fix<br>
270959  s390x: invalid use of R0 as base register<br>
271042  VSX configure check fails when it should not <br>
271043  Valgrind build fails with assembler error on ppc64 with binutils 2.21 <br>
271259  s390x: fix code confusion <br>
271337  == 267997 (Valgrind segfaults on MacOS X)<br>
271385  s390x: Implement Ist_MBE <br>
271501  s390x: misc cleanups <br>
271504  s390x: promote likely and unlikely <br>
271579  ppc: using wrong enum type <br>
271615  unhandled instruction "popcnt" (arch=amd10h) <br>
271730  Fix bug when checking ioctls: duplicate check <br>
271776  s390x: provide STFLE instruction support <br>
271779  s390x: provide clock instructions like STCK <br>
271799  Darwin: ioctls without an arg report a memory error <br>
271820  arm: fix type confusion <br>
271917  pthread_cond_timedwait failure leads to not-locked false positive <br>
272067  s390x: fix DISP20 macro <br>
272615  A typo in debug output in mc_leakcheck.c<br>
272661  callgrind_annotate chokes when run from paths containing regex chars<br>
272893  amd64-&gt;IR: 0x66 0xF 0x38 0x2B 0xC1 0x66 0xF 0x7F == (closed as dup)<br>
272955  Unhandled syscall error for pwrite64 on ppc64 arch <br>
272967  make documentation build-system more robust <br>
272986  Fix gcc-4.6 warnings with valgrind.h<br>
273318  amd64-&gt;IR: 0x66 0xF 0x3A 0x61 0xC1 0x38 (missing PCMPxSTRx case)<br>
273318  unhandled PCMPxSTRx case: vex amd64-&gt;IR: 0x66 0xF 0x3A 0x61 0xC1 0x38 <br>
273431  valgrind segfaults in evalCfiExpr (debuginfo.c:2039)<br>
273465  Callgrind: jumps.c:164 (new_jcc): Assertion '(0 &lt;= jmp) &amp;&amp; ...'<br>
273536  Build error: multiple definition of `vgDrd_pthread_cond_initializer'<br>
273640  ppc64-linux: unhandled syscalls setresuid(164) and setresgid(169)<br>
273729  == 283000 (Illegal opcode for SSE2 "roundsd" instruction)<br>
273778  exp-ptrcheck: unhandled sysno == 259<br>
274089  exp-ptrcheck: unhandled sysno == 208<br>
274378  s390x: Various dispatcher tweaks<br>
274447  WARNING: unhandled syscall: 340<br>
274776  amd64-&gt;IR: 0x66 0xF 0x38 0x2B 0xC5 0x66<br>
274784  == 267997 (valgrind ls -l results in Segmentation Fault)<br>
274926  valgrind does not build against linux-3<br>
275148  configure FAIL with glibc-2.14<br>
275151  Fedora 15 / glibc-2.14 'make regtest' FAIL<br>
275168  Make Valgrind work for MacOSX 10.7 Lion<br>
275212  == 275284 (lots of false positives from __memcpy_ssse3_back et al)<br>
275278  valgrind does not build on Linux kernel 3.0.* due to silly<br>
275284  Valgrind memcpy/memmove redirection stopped working in glibc 2.14/x86_64<br>
275308  Fix implementation for ppc64 fres instruc<br>
275339  s390x: fix testcase compile warnings<br>
275517  s390x: Provide support for CKSM instruction<br>
275710  s390x: get rid of redundant address mode calculation<br>
275815  == 247894 (Valgrind doesn't know about Linux readahead(2) syscall)<br>
275852  == 250101 (valgrind uses all swap space and is killed)<br>
276784  Add support for IBM Power ISA 2.06 -- stage 3<br>
276987  gdbsrv: fix tests following recent commits<br>
277045  Valgrind crashes with  unhandled DW_OP_ opcode 0x2a<br>
277199  The test_isa_2_06_part1.c in none/tests/ppc64 should be a symlink<br>
277471  Unhandled syscall: 340<br>
277610  valgrind crashes in VG_(lseek)(core_fd, phdrs[idx].p_offset, ...)<br>
277653  ARM: support Thumb2 PLD instruction<br>
277663  ARM: NEON float VMUL by scalar incorrect<br>
277689  ARM: tests for VSTn with register post-index are broken<br>
277694  ARM: BLX LR instruction broken in ARM mode<br>
277780  ARM: VMOV.F32 (immediate) instruction is broken<br>
278057  fuse filesystem syscall deadlocks<br>
278078  Unimplemented syscall 280 on ppc32<br>
278349  F_GETPIPE_SZ and  F_SETPIPE_SZ Linux fcntl commands<br>
278454  VALGRIND_STACK_DEREGISTER has wrong output type<br>
278502  == 275284 (Valgrind confuses memcpy() and memmove())<br>
278892  gdbsrv: factorize gdb version handling, fix doc and typos<br>
279027  Support for MVCL and CLCL instruction<br>
279027  s390x: Provide support for CLCL and MVCL instructions<br>
279062  Remove a redundant check in the insn selector for ppc.<br>
279071  JDK creates PTEST with redundant REX.W prefix<br>
279212  gdbsrv: add monitor cmd v.info scheduler.<br>
279378  exp-ptrcheck: the 'impossible' happened on mkfifo call<br>
279698  memcheck discards valid-bits for packuswb<br>
279795  memcheck reports uninitialised values for mincore on amd64<br>
279994  Add support for IBM Power ISA 2.06 -- stage 3<br>
280083  mempolicy syscall check errors<br>
280290  vex amd64-&gt;IR: 0x66 0xF 0x38 0x28 0xC1 0x66 0xF 0x6F<br>
280710  s390x: config files for nightly builds<br>
280757  /tmp dir still used by valgrind even if TMPDIR is specified<br>
280965  Valgrind breaks fcntl locks when program does mmap<br>
281138  WARNING: unhandled syscall: 340<br>
281241  == 275168 (valgrind useless on Macos 10.7.1 Lion)<br>
281304  == 275168 (Darwin: dyld "cannot load inserted library")<br>
281305  == 275168 (unhandled syscall: unix:357 on Darwin 11.1)<br>
281468  s390x: handle do_clone and gcc clones in call traces<br>
281488  ARM: VFP register corruption<br>
281828  == 275284 (false memmove warning: "Source and destination overlap")<br>
281883  s390x: Fix system call wrapper for "clone".<br>
282105  generalise 'reclaimSuperBlock' to also reclaim splittable superblock<br>
282112  Unhandled instruction bytes: 0xDE 0xD9 0x9B 0xDF (fcompp)<br>
282238  SLES10: make check fails<br>
282979  strcasestr needs replacement with recent(&gt;=2.12) glibc<br>
283000  vex amd64-&gt;IR: 0x66 0xF 0x3A 0xA 0xC0 0x9 0xF3 0xF<br>
283243  Regression in ppc64 memcheck tests<br>
283325  == 267997 (Darwin: V segfaults on startup when built with Xcode 4.0)<br>
283427  re-connect epoll_pwait syscall on ARM linux<br>
283600  gdbsrv: android: port vgdb.c<br>
283709  none/tests/faultstatus needs to account for page size<br>
284305  filter_gdb needs enhancement to work on ppc64<br>
284384  clang 3.1 -Wunused-value warnings in valgrind.h, memcheck.h<br>
284472  Thumb2 ROR.W encoding T2 not implemented<br>
284621  XML-escape process command line in XML output<br>
n-i-bz  cachegrind/callgrind: handle CPUID information for Core iX Intel CPUs<br>
        that have non-power-of-2 sizes (also AMDs)<br>
n-i-bz  don't be spooked by libraries mashed by elfhack<br>
n-i-bz  don't be spooked by libxul.so linked with gold<br>
n-i-bz  improved checking for VALGRIND_CHECK_MEM_IS_DEFINED<br>
<br>
(3.7.0-TEST1: 27  October 2011, vex r2228, valgrind r12245)<br>
(3.7.0.RC1:    1 November 2011, vex r2231, valgrind r12257)<br>
(3.7.0:        5 November 2011, vex r2231, valgrind r12258)<br>
<br>
<br>
<br>
Release 3.6.1 (16 February 2011)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.6.1 is a bug fix release.  It adds support for some SSE4<br>
instructions that were omitted in 3.6.0 due to lack of time.  Initial<br>
support for glibc-2.13 has been added.  A number of bugs causing<br>
crashing or assertion failures have been fixed.<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (http://bugs.kde.org/enter_valgrind_bug.cgi) rather than<br>
mailing the developers (or mailing lists) directly -- bugs that are<br>
not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
188572  Valgrind on Mac should suppress setenv() mem leak<br>
194402  vex amd64-&gt;IR: 0x48 0xF 0xAE 0x4 (proper FX{SAVE,RSTOR} support)<br>
210481  vex amd64-&gt;IR: Assertion `sz == 2 || sz == 4' failed (REX.W POPQ)<br>
246152  callgrind internal error after pthread_cancel on 32 Bit Linux<br>
250038  ppc64: Altivec LVSR and LVSL instructions fail their regtest<br>
254420  memory pool tracking broken <br>
254957  Test code failing to compile due to changes in memcheck.h<br>
255009  helgrind/drd: crash on chmod with invalid parameter<br>
255130  readdwarf3.c parse_type_DIE confused by GNAT Ada types<br>
255355  helgrind/drd: crash on threaded programs doing fork<br>
255358  == 255355<br>
255418  (SSE4.x) rint call compiled with ICC<br>
255822  --gen-suppressions can create invalid files: "too many callers [...]"<br>
255888  closing valgrindoutput tag outputted to log-stream on error<br>
255963  (SSE4.x) vex amd64-&gt;IR: 0x66 0xF 0x3A 0x9 0xDB 0x0 (ROUNDPD)<br>
255966  Slowness when using mempool annotations<br>
256387  vex x86-&gt;IR: 0xD4 0xA 0x2 0x7 (AAD and AAM)<br>
256600  super-optimized strcasecmp() false positive<br>
256669  vex amd64-&gt;IR: Unhandled LOOPNEL insn on amd64<br>
256968  (SSE4.x) vex amd64-&gt;IR: 0x66 0xF 0x38 0x10 0xD3 0x66 (BLENDVPx)<br>
257011  (SSE4.x) vex amd64-&gt;IR: 0x66 0xF 0x3A 0xE 0xFD 0xA0 (PBLENDW)<br>
257063  (SSE4.x) vex amd64-&gt;IR: 0x66 0xF 0x3A 0x8 0xC0 0x0 (ROUNDPS)<br>
257276  Missing case in memcheck --track-origins=yes<br>
258870  (SSE4.x) Add support for EXTRACTPS SSE 4.1 instruction<br>
261966  (SSE4.x) support for CRC32B and CRC32Q is lacking (also CRC32{W,L})<br>
262985  VEX regression in valgrind 3.6.0 in handling PowerPC VMX<br>
262995  (SSE4.x) crash when trying to valgrind gcc-snapshot (PCMPxSTRx $0)<br>
263099  callgrind_annotate counts Ir improperly [...]<br>
263877  undefined coprocessor instruction on ARMv7<br>
265964  configure FAIL with glibc-2.13<br>
n-i-bz  Fix compile error w/ icc-12.x in guest_arm_toIR.c<br>
n-i-bz  Docs: fix bogus descriptions for VALGRIND_CREATE_BLOCK et al<br>
n-i-bz  Massif: don't assert on shmat() with --pages-as-heap=yes<br>
n-i-bz  Bug fixes and major speedups for the exp-DHAT space profiler<br>
n-i-bz  DRD: disable --free-is-write due to implementation difficulties<br>
<br>
(3.6.1: 16 February 2011, vex r2103, valgrind r11561).<br>
<br>
<br>
<br>
Release 3.6.0 (21 October 2010)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.6.0 is a feature release with many significant improvements and the<br>
usual collection of bug fixes.<br>
<br>
This release supports X86/Linux, AMD64/Linux, ARM/Linux, PPC32/Linux,<br>
PPC64/Linux, X86/Darwin and AMD64/Darwin.  Support for recent distros<br>
and toolchain components (glibc 2.12, gcc 4.5, OSX 10.6) has been added.<br>
<br>
                    -------------------------<br>
<br>
Here are some highlights.  Details are shown further down:<br>
<br>
* Support for ARM/Linux.<br>
<br>
* Support for recent Linux distros: Ubuntu 10.10 and Fedora 14.<br>
<br>
* Support for Mac OS X 10.6, both 32- and 64-bit executables.<br>
<br>
* Support for the SSE4.2 instruction set.<br>
<br>
* Enhancements to the Callgrind profiler, including the ability to<br>
  handle CPUs with three levels of cache.<br>
<br>
* A new experimental heap profiler, DHAT.<br>
<br>
* A huge number of bug fixes and small enhancements.<br>
<br>
                    -------------------------<br>
<br>
Here are details of the above changes, together with descriptions of<br>
many other changes, and a list of fixed bugs.<br>
<br>
* ================== PLATFORM CHANGES =================<br>
<br>
* Support for ARM/Linux.  Valgrind now runs on ARMv7 capable CPUs<br>
  running Linux.  It is known to work on Ubuntu 10.04, Ubuntu 10.10,<br>
  and Maemo 5, so you can run Valgrind on your Nokia N900 if you want.<br>
<br>
  This requires a CPU capable of running the ARMv7-A instruction set<br>
  (Cortex A5, A8 and A9).  Valgrind provides fairly complete coverage<br>
  of the user space instruction set, including ARM and Thumb integer<br>
  code, VFPv3, NEON and V6 media instructions.  The Memcheck,<br>
  Cachegrind and Massif tools work properly; other tools work to<br>
  varying degrees.<br>
<br>
* Support for recent Linux distros (Ubuntu 10.10 and Fedora 14), along<br>
  with support for recent releases of the underlying toolchain<br>
  components, notably gcc-4.5 and glibc-2.12.<br>
<br>
* Support for Mac OS X 10.6, both 32- and 64-bit executables.  64-bit<br>
  support also works much better on OS X 10.5, and is as solid as<br>
  32-bit support now.<br>
<br>
* Support for the SSE4.2 instruction set.  SSE4.2 is supported in<br>
  64-bit mode.  In 32-bit mode, support is only available up to and<br>
  including SSSE3.  Some exceptions: SSE4.2 AES instructions are not<br>
  supported in 64-bit mode, and 32-bit mode does in fact support the<br>
  bare minimum SSE4 instructions to needed to run programs on Mac OS X<br>
  10.6 on 32-bit targets.<br>
<br>
* Support for IBM POWER6 cpus has been improved.  The Power ISA up to<br>
  and including version 2.05 is supported.<br>
<br>
* ==================== TOOL CHANGES ====================<br>
<br>
* Cachegrind has a new processing script, cg_diff, which finds the<br>
  difference between two profiles.  It's very useful for evaluating<br>
  the performance effects of a change in a program.<br>
  <br>
  Related to this change, the meaning of cg_annotate's (rarely-used)<br>
  --threshold option has changed; this is unlikely to affect many<br>
  people, if you do use it please see the user manual for details.<br>
<br>
* Callgrind now can do branch prediction simulation, similar to<br>
  Cachegrind.  In addition, it optionally can count the number of<br>
  executed global bus events.  Both can be used for a better<br>
  approximation of a "Cycle Estimation" as derived event (you need to<br>
  update the event formula in KCachegrind yourself).<br>
<br>
* Cachegrind and Callgrind now refer to the LL (last-level) cache<br>
  rather than the L2 cache.  This is to accommodate machines with<br>
  three levels of caches -- if Cachegrind/Callgrind auto-detects the<br>
  cache configuration of such a machine it will run the simulation as<br>
  if the L2 cache isn't present.  This means the results are less<br>
  likely to match the true result for the machine, but<br>
  Cachegrind/Callgrind's results are already only approximate, and<br>
  should not be considered authoritative.  The results are still<br>
  useful for giving a general idea about a program's locality.<br>
<br>
* Massif has a new option, --pages-as-heap, which is disabled by<br>
  default.  When enabled, instead of tracking allocations at the level<br>
  of heap blocks (as allocated with malloc/new/new[]), it instead<br>
  tracks memory allocations at the level of memory pages (as mapped by<br>
  mmap, brk, etc).  Each mapped page is treated as its own block.<br>
  Interpreting the page-level output is harder than the heap-level<br>
  output, but this option is useful if you want to account for every<br>
  byte of memory used by a program.<br>
<br>
* DRD has two new command-line options: --free-is-write and<br>
  --trace-alloc.  The former allows to detect reading from already freed<br>
  memory, and the latter allows tracing of all memory allocations and<br>
  deallocations.<br>
<br>
* DRD has several new annotations.  Custom barrier implementations can<br>
  now be annotated, as well as benign races on static variables.<br>
<br>
* DRD's happens before / happens after annotations have been made more<br>
  powerful, so that they can now also be used to annotate e.g. a smart<br>
  pointer implementation.<br>
<br>
* Helgrind's annotation set has also been drastically improved, so as<br>
  to provide to users a general set of annotations to describe locks,<br>
  semaphores, barriers and condition variables.  Annotations to<br>
  describe thread-safe reference counted heap objects have also been<br>
  added.<br>
<br>
* Memcheck has a new command-line option, --show-possibly-lost, which<br>
  is enabled by default.  When disabled, the leak detector will not<br>
  show possibly-lost blocks.<br>
<br>
* A new experimental heap profiler, DHAT (Dynamic Heap Analysis Tool),<br>
  has been added.  DHAT keeps track of allocated heap blocks, and also<br>
  inspects every memory reference to see which block (if any) is being<br>
  accessed.  This gives a lot of insight into block lifetimes,<br>
  utilisation, turnover, liveness, and the location of hot and cold<br>
  fields.  You can use DHAT to do hot-field profiling.<br>
<br>
* ==================== OTHER CHANGES ====================<br>
<br>
* Improved support for unfriendly self-modifying code: the extra<br>
  overhead incurred by --smc-check=all has been reduced by<br>
  approximately a factor of 5 as compared with 3.5.0.<br>
<br>
* Ability to show directory names for source files in error messages.<br>
  This is combined with a flexible mechanism for specifying which<br>
  parts of the paths should be shown.  This is enabled by the new flag<br>
  --fullpath-after.<br>
<br>
* A new flag, --require-text-symbol, which will stop the run if a<br>
  specified symbol is not found it a given shared object when it is<br>
  loaded into the process.  This makes advanced working with function<br>
  intercepting and wrapping safer and more reliable.<br>
<br>
* Improved support for the Valkyrie GUI, version 2.0.0.  GUI output<br>
  and control of Valgrind is now available for the tools Memcheck and<br>
  Helgrind.  XML output from Valgrind is available for Memcheck,<br>
  Helgrind and exp-Ptrcheck.<br>
<br>
* More reliable stack unwinding on amd64-linux, particularly in the<br>
  presence of function wrappers, and with gcc-4.5 compiled code.<br>
<br>
* Modest scalability (performance improvements) for massive<br>
  long-running applications, particularly for those with huge amounts<br>
  of code.<br>
<br>
* Support for analyzing programs running under Wine with has been<br>
  improved.  The header files &lt;valgrind/valgrind.h&gt;,<br>
  &lt;valgrind/memcheck.h&gt; and &lt;valgrind/drd.h&gt; can now be used in<br>
  Windows-programs compiled with MinGW or one of the Microsoft Visual<br>
  Studio compilers.<br>
<br>
* A rare but serious error in the 64-bit x86 CPU simulation was fixed.<br>
  The 32-bit simulator was not affected.  This did not occur often,<br>
  but when it did would usually crash the program under test.<br>
  Bug 245925.<br>
<br>
* A large number of bugs were fixed.  These are shown below.<br>
<br>
* A number of bugs were investigated, and were candidates for fixing,<br>
  but are not fixed in 3.6.0, due to lack of developer time.  They may<br>
  get fixed in later releases.  They are:<br>
<br>
  194402  vex amd64-&gt;IR: 0x48 0xF 0xAE 0x4 0x24 0x49  (FXSAVE64)<br>
  212419  false positive "lock order violated" (A+B vs A) <br>
  213685  Undefined value propagates past dependency breaking instruction<br>
  216837  Incorrect instrumentation of NSOperationQueue on Darwin <br>
  237920  valgrind segfault on fork failure <br>
  242137  support for code compiled by LLVM-2.8<br>
  242423  Another unknown Intel cache config value <br>
  243232  Inconsistent Lock Orderings report with trylock <br>
  243483  ppc: callgrind triggers VEX assertion failure <br>
  243935  Helgrind: implementation of ANNOTATE_HAPPENS_BEFORE() is wrong<br>
  244677  Helgrind crash hg_main.c:616 (map_threads_lookup): Assertion<br>
          'thr' failed. <br>
  246152  callgrind internal error after pthread_cancel on 32 Bit Linux <br>
  249435  Analyzing wine programs with callgrind triggers a crash <br>
  250038  ppc64: Altivec lvsr and lvsl instructions fail their regtest<br>
  250065  Handling large allocations <br>
  250101  huge "free" memory usage due to m_mallocfree.c<br>
          "superblocks fragmentation"<br>
  251569  vex amd64-&gt;IR: 0xF 0x1 0xF9 0x8B 0x4C 0x24 (RDTSCP)<br>
  252091  Callgrind on ARM does not detect function returns correctly<br>
  252600  [PATCH] Allow lhs to be a pointer for shl/shr<br>
  254420  memory pool tracking broken<br>
  n-i-bz  support for adding symbols for JIT generated code<br>
<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (http://bugs.kde.org/enter_valgrind_bug.cgi) rather than<br>
mailing the developers (or mailing lists) directly -- bugs that are<br>
not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
135264  dcbzl instruction missing<br>
142688  == 250799<br>
153699  Valgrind should report unaligned reads with movdqa<br>
180217  == 212335<br>
190429  Valgrind reports lost of errors in ld.so<br>
        with x86_64 2.9.90 glibc <br>
197266  valgrind appears to choke on the xmms instruction<br>
        "roundsd" on x86_64 <br>
197988  Crash when demangling very large symbol names<br>
202315  unhandled syscall: 332 (inotify_init1)<br>
203256  Add page-level profiling to Massif<br>
205093  dsymutil=yes needs quotes, locking (partial fix)<br>
205241  Snow Leopard 10.6 support (partial fix)<br>
206600  Leak checker fails to upgrade indirect blocks when their<br>
        parent becomes reachable <br>
210935  port valgrind.h (not valgrind) to win32 so apps run under<br>
        wine can make client requests<br>
211410  vex amd64-&gt;IR: 0x15 0xFF 0xFF 0x0 0x0 0x89<br>
        within Linux ip-stack checksum functions <br>
212335  unhandled instruction bytes: 0xF3 0xF 0xBD 0xC0<br>
        (lzcnt %eax,%eax) <br>
213685  Undefined value propagates past dependency breaking instruction<br>
        (partial fix)<br>
215914  Valgrind inserts bogus empty environment variable <br>
217863  == 197988<br>
219538  adjtimex syscall wrapper wrong in readonly adjtime mode <br>
222545  shmat fails under valgind on some arm targets <br>
222560  ARM NEON support <br>
230407  == 202315<br>
231076  == 202315<br>
232509  Docs build fails with formatting inside &lt;title&gt;&lt;/title&gt; elements <br>
232793  == 202315<br>
235642  [PATCH] syswrap-linux.c: support evdev EVIOCG* ioctls <br>
236546  vex x86-&gt;IR: 0x66 0xF 0x3A 0xA<br>
237202  vex amd64-&gt;IR: 0xF3 0xF 0xB8 0xC0 0x49 0x3B <br>
237371  better support for VALGRIND_MALLOCLIKE_BLOCK <br>
237485  symlink (syscall 57) is not supported on Mac OS <br>
237723  sysno == 101 exp-ptrcheck: the 'impossible' happened:<br>
        unhandled syscall <br>
238208  is_just_below_ESP doesn't take into account red-zone <br>
238345  valgrind passes wrong $0 when executing a shell script <br>
238679  mq_timedreceive syscall doesn't flag the reception buffer<br>
        as "defined"<br>
238696  fcntl command F_DUPFD_CLOEXEC not supported <br>
238713  unhandled instruction bytes: 0x66 0xF 0x29 0xC6 <br>
238713  unhandled instruction bytes: 0x66 0xF 0x29 0xC6 <br>
238745  3.5.0 Make fails on PPC Altivec opcodes, though configure<br>
        says "Altivec off"<br>
239992  vex amd64-&gt;IR: 0x48 0xF 0xC4 0xC1 0x0 0x48 <br>
240488  == 197988<br>
240639  == 212335<br>
241377  == 236546<br>
241903  == 202315<br>
241920  == 212335<br>
242606  unhandled syscall: setegid (in Ptrcheck)<br>
242814  Helgrind "Impossible has happened" during<br>
        QApplication::initInstance(); <br>
243064  Valgrind attempting to read debug information from iso <br>
243270  Make stack unwinding in Valgrind wrappers more reliable<br>
243884  exp-ptrcheck: the 'impossible happened: unhandled syscall <br>
        sysno = 277 (mq_open)<br>
244009  exp-ptrcheck unknown syscalls in analyzing lighttpd<br>
244493  ARM VFP d16-d31 registers support <br>
244670  add support for audit_session_self syscall on Mac OS 10.6<br>
244921  The xml report of helgrind tool is not well format<br>
244923  In the xml report file, the &lt;preamble&gt; not escape the <br>
        xml char, eg '&lt;','&amp;','&gt;'<br>
245535  print full path names in plain text reports <br>
245925  x86-64 red zone handling problem <br>
246258  Valgrind not catching integer underruns + new [] s<br>
246311  reg/reg cmpxchg doesn't work on amd64<br>
246549  unhandled syscall unix:277 while testing 32-bit Darwin app <br>
246888  Improve Makefile.vex.am <br>
247510  [OS X 10.6] Memcheck reports unaddressable bytes passed <br>
        to [f]chmod_extended<br>
247526  IBM POWER6 (ISA 2.05) support is incomplete<br>
247561  Some leak testcases fails due to reachable addresses in<br>
        caller save regs<br>
247875  sizeofIRType to handle Ity_I128 <br>
247894  [PATCH] unhandled syscall sys_readahead <br>
247980  Doesn't honor CFLAGS passed to configure <br>
248373  darwin10.supp is empty in the trunk <br>
248822  Linux FIBMAP ioctl has int parameter instead of long<br>
248893  [PATCH] make readdwarf.c big endianess safe to enable<br>
        unwinding on big endian systems<br>
249224  Syscall 336 not supported (SYS_proc_info) <br>
249359  == 245535<br>
249775  Incorrect scheme for detecting NEON capabilities of host CPU<br>
249943  jni JVM init fails when using valgrind<br>
249991  Valgrind incorrectly declares AESKEYGENASSIST support<br>
        since VEX r2011<br>
249996  linux/arm: unhandled syscall: 181 (__NR_pwrite64)<br>
250799  frexp$fenv_access_off function generates SIGILL <br>
250998  vex x86-&gt;IR: unhandled instruction bytes: 0x66 0x66 0x66 0x2E <br>
251251  support pclmulqdq insn <br>
251362  valgrind: ARM: attach to debugger either fails or provokes<br>
        kernel oops <br>
251674  Unhandled syscall 294<br>
251818  == 254550<br>
<br>
254257  Add support for debugfiles found by build-id<br>
254550  [PATCH] Implement DW_ATE_UTF (DWARF4)<br>
254646  Wrapped functions cause stack misalignment on OS X<br>
        (and possibly Linux)<br>
254556  ARM: valgrinding anything fails with SIGSEGV for 0xFFFF0FA0<br>
<br>
(3.6.0: 21 October 2010, vex r2068, valgrind r11471).<br>
<br>
<br>
<br>
Release 3.5.0 (19 August 2009)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.5.0 is a feature release with many significant improvements and the<br>
usual collection of bug fixes.  The main improvement is that Valgrind<br>
now works on Mac OS X.<br>
<br>
This release supports X86/Linux, AMD64/Linux, PPC32/Linux, PPC64/Linux<br>
and X86/Darwin.  Support for recent distros and toolchain components<br>
(glibc 2.10, gcc 4.5) has been added.<br>
<br>
                    -------------------------<br>
<br>
Here is a short summary of the changes.  Details are shown further<br>
down:<br>
<br>
* Support for Mac OS X (10.5.x).<br>
<br>
* Improvements and simplifications to Memcheck's leak checker.<br>
<br>
* Clarification and simplifications in various aspects of Valgrind's<br>
  text output.<br>
<br>
* XML output for Helgrind and Ptrcheck.<br>
<br>
* Performance and stability improvements for Helgrind and DRD.<br>
<br>
* Genuinely atomic support for x86/amd64/ppc atomic instructions.<br>
<br>
* A new experimental tool, BBV, useful for computer architecture<br>
  research.<br>
<br>
* Improved Wine support, including ability to read Windows PDB<br>
  debuginfo.<br>
<br>
                    -------------------------<br>
<br>
Here are details of the above changes, followed by descriptions of<br>
many other minor changes, and a list of fixed bugs.<br>
<br>
<br>
* Valgrind now runs on Mac OS X.  (Note that Mac OS X is sometimes<br>
  called "Darwin" because that is the name of the OS core, which is the<br>
  level that Valgrind works at.)<br>
<br>
  Supported systems:<br>
<br>
  - It requires OS 10.5.x (Leopard).  Porting to 10.4.x is not planned<br>
    because it would require work and 10.4 is only becoming less common.<br>
<br>
  - 32-bit programs on x86 and AMD64 (a.k.a x86-64) machines are supported<br>
    fairly well.  For 10.5.x, 32-bit programs are the default even on<br>
    64-bit machines, so it handles most current programs.<br>
    <br>
  - 64-bit programs on x86 and AMD64 (a.k.a x86-64) machines are not<br>
    officially supported, but simple programs at least will probably work.<br>
    However, start-up is slow.<br>
<br>
  - PowerPC machines are not supported.<br>
<br>
  Things that don't work:<br>
<br>
  - The Ptrcheck tool.<br>
<br>
  - Objective-C garbage collection.<br>
<br>
  - --db-attach=yes.<br>
<br>
  - If you have Rogue Amoeba's "Instant Hijack" program installed,<br>
    Valgrind will fail with a SIGTRAP at start-up.  See<br>
    https://bugs.kde.org/show_bug.cgi?id=193917 for details and a<br>
    simple work-around.<br>
<br>
  Usage notes:<br>
<br>
  - You will likely find --dsymutil=yes a useful option, as error<br>
    messages may be imprecise without it.<br>
<br>
  - Mac OS X support is new and therefore will be less robust than the<br>
    Linux support.  Please report any bugs you find.<br>
<br>
  - Threaded programs may run more slowly than on Linux.<br>
<br>
  Many thanks to Greg Parker for developing this port over several years.<br>
<br>
<br>
* Memcheck's leak checker has been improved.  <br>
<br>
  - The results for --leak-check=summary now match the summary results<br>
    for --leak-check=full.  Previously they could differ because<br>
    --leak-check=summary counted "indirectly lost" blocks and<br>
    "suppressed" blocks as "definitely lost".<br>
<br>
  - Blocks that are only reachable via at least one interior-pointer,<br>
    but are directly pointed to by a start-pointer, were previously<br>
    marked as "still reachable".  They are now correctly marked as<br>
    "possibly lost".<br>
<br>
  - The default value for the --leak-resolution option has been<br>
    changed from "low" to "high".  In general, this means that more<br>
    leak reports will be produced, but each leak report will describe<br>
    fewer leaked blocks.<br>
<br>
  - With --leak-check=full, "definitely lost" and "possibly lost"<br>
    leaks are now considered as proper errors, ie. they are counted<br>
    for the "ERROR SUMMARY" and affect the behaviour of<br>
    --error-exitcode.  These leaks are not counted as errors if<br>
    --leak-check=summary is specified, however.<br>
<br>
  - Documentation for the leak checker has been improved.<br>
<br>
<br>
* Various aspects of Valgrind's text output have changed.<br>
<br>
  - Valgrind's start-up message has changed.  It is shorter but also<br>
    includes the command being run, which makes it easier to use<br>
    --trace-children=yes.  An example:<br>
<br>
  - Valgrind's shut-down messages have also changed.  This is most<br>
    noticeable with Memcheck, where the leak summary now occurs before<br>
    the error summary.  This change was necessary to allow leaks to be<br>
    counted as proper errors (see the description of the leak checker<br>
    changes above for more details).  This was also necessary to fix a<br>
    longstanding bug in which uses of suppressions against leaks were<br>
    not "counted", leading to difficulties in maintaining suppression<br>
    files (see https://bugs.kde.org/show_bug.cgi?id=186790).<br>
<br>
  - Behavior of -v has changed.  In previous versions, -v printed out<br>
    a mixture of marginally-user-useful information, and tool/core<br>
    statistics.  The statistics printing has now been moved to its own<br>
    flag, --stats=yes.  This means -v is less verbose and more likely<br>
    to convey useful end-user information.<br>
<br>
  - The format of some (non-XML) stack trace entries has changed a<br>
    little.  Previously there were six possible forms:<br>
<br>
      0x80483BF: really (a.c:20)<br>
      0x80483BF: really (in /foo/a.out)<br>
      0x80483BF: really<br>
      0x80483BF: (within /foo/a.out)<br>
      0x80483BF: ??? (a.c:20)<br>
      0x80483BF: ???<br>
<br>
    The third and fourth of these forms have been made more consistent<br>
    with the others.  The six possible forms are now:<br>
  <br>
      0x80483BF: really (a.c:20)<br>
      0x80483BF: really (in /foo/a.out)<br>
      0x80483BF: really (in ???)<br>
      0x80483BF: ??? (in /foo/a.out)<br>
      0x80483BF: ??? (a.c:20)<br>
      0x80483BF: ???<br>
<br>
    Stack traces produced when --xml=yes is specified are different<br>
    and unchanged.<br>
<br>
<br>
* Helgrind and Ptrcheck now support XML output, so they can be used<br>
  from GUI tools.  Also, the XML output mechanism has been<br>
  overhauled.<br>
<br>
  - The XML format has been overhauled and generalised, so it is more<br>
    suitable for error reporting tools in general.  The Memcheck<br>
    specific aspects of it have been removed.  The new format, which<br>
    is an evolution of the old format, is described in<br>
    docs/internals/xml-output-protocol4.txt.<br>
<br>
  - Memcheck has been updated to use the new format.<br>
<br>
  - Helgrind and Ptrcheck are now able to emit output in this format.<br>
<br>
  - The XML output mechanism has been overhauled.  XML is now output<br>
    to its own file descriptor, which means that:<br>
<br>
    * Valgrind can output text and XML independently.<br>
<br>
    * The longstanding problem of XML output being corrupted by <br>
      unexpected un-tagged text messages  is solved.<br>
<br>
    As before, the destination for text output is specified using<br>
    --log-file=, --log-fd= or --log-socket=.<br>
<br>
    As before, XML output for a tool is enabled using --xml=yes.<br>
<br>
    Because there's a new XML output channel, the XML output<br>
    destination is now specified by --xml-file=, --xml-fd= or<br>
    --xml-socket=.<br>
<br>
    Initial feedback has shown this causes some confusion.  To<br>
    clarify, the two envisaged usage scenarios are:<br>
<br>
    (1) Normal text output.  In this case, do not specify --xml=yes<br>
        nor any of --xml-file=, --xml-fd= or --xml-socket=.<br>
<br>
    (2) XML output.  In this case, specify --xml=yes, and one of<br>
        --xml-file=, --xml-fd= or --xml-socket= to select the XML<br>
        destination, one of --log-file=, --log-fd= or --log-socket=<br>
        to select the destination for any remaining text messages,<br>
        and, importantly, -q.<br>
<br>
        -q makes Valgrind completely silent on the text channel,<br>
        except in the case of critical failures, such as Valgrind<br>
        itself segfaulting, or failing to read debugging information.<br>
        Hence, in this scenario, it suffices to check whether or not<br>
        any output appeared on the text channel.  If yes, then it is<br>
        likely to be a critical error which should be brought to the<br>
        attention of the user.  If no (the text channel produced no<br>
        output) then it can be assumed that the run was successful.<br>
<br>
        This allows GUIs to make the critical distinction they need to<br>
        make (did the run fail or not?) without having to search or<br>
        filter the text output channel in any way.<br>
<br>
    It is also recommended to use --child-silent-after-fork=yes in<br>
    scenario (2).<br>
<br>
<br>
* Improvements and changes in Helgrind:<br>
<br>
  - XML output, as described above<br>
<br>
  - Checks for consistent association between pthread condition<br>
    variables and their associated mutexes are now performed.<br>
<br>
  - pthread_spinlock functions are supported.<br>
<br>
  - Modest performance improvements.<br>
<br>
  - Initial (skeletal) support for describing the behaviour of<br>
    non-POSIX synchronisation objects through ThreadSanitizer<br>
    compatible ANNOTATE_* macros.<br>
<br>
  - More controllable tradeoffs between performance and the level of<br>
    detail of "previous" accesses in a race.  There are now three<br>
    settings:<br>
<br>
    * --history-level=full.  This is the default, and was also the<br>
      default in 3.4.x.  It shows both stacks involved in a race, but<br>
      requires a lot of memory and can be very slow in programs that<br>
      do many inter-thread synchronisation events.<br>
<br>
    * --history-level=none.  This only shows the later stack involved<br>
      in a race.  This can be much faster than --history-level=full,<br>
      but makes it much more difficult to find the other access<br>
      involved in the race.<br>
<br>
    The new intermediate setting is<br>
<br>
    * --history-level=approx<br>
<br>
      For the earlier (other) access, two stacks are presented.  The<br>
      earlier access is guaranteed to be somewhere in between the two<br>
      program points denoted by those stacks.  This is not as useful<br>
      as showing the exact stack for the previous access (as per<br>
      --history-level=full), but it is better than nothing, and it's<br>
      almost as fast as --history-level=none.<br>
<br>
<br>
* New features and improvements in DRD:<br>
<br>
  - The error messages printed by DRD are now easier to interpret.<br>
    Instead of using two different numbers to identify each thread<br>
    (Valgrind thread ID and DRD thread ID), DRD does now identify<br>
    threads via a single number (the DRD thread ID).  Furthermore<br>
    "first observed at" information is now printed for all error<br>
    messages related to synchronization objects.<br>
<br>
  - Added support for named semaphores (sem_open() and sem_close()).<br>
<br>
  - Race conditions between pthread_barrier_wait() and<br>
    pthread_barrier_destroy() calls are now reported.<br>
<br>
  - Added support for custom allocators through the macros<br>
    VALGRIND_MALLOCLIKE_BLOCK() VALGRIND_FREELIKE_BLOCK() (defined in<br>
    in &lt;valgrind/valgrind.h&gt;). An alternative for these two macros is<br>
    the new client request VG_USERREQ__DRD_CLEAN_MEMORY (defined in<br>
    &lt;valgrind/drd.h&gt;).<br>
<br>
  - Added support for annotating non-POSIX synchronization objects<br>
    through several new ANNOTATE_*() macros.<br>
<br>
  - OpenMP: added support for the OpenMP runtime (libgomp) included<br>
    with gcc versions 4.3.0 and 4.4.0.<br>
<br>
  - Faster operation.<br>
<br>
  - Added two new command-line options (--first-race-only and<br>
    --segment-merging-interval).<br>
<br>
<br>
* Genuinely atomic support for x86/amd64/ppc atomic instructions<br>
<br>
  Valgrind will now preserve (memory-access) atomicity of LOCK-<br>
  prefixed x86/amd64 instructions, and any others implying a global<br>
  bus lock.  Ditto for PowerPC l{w,d}arx/st{w,d}cx. instructions.<br>
<br>
  This means that Valgrinded processes will "play nicely" in<br>
  situations where communication with other processes, or the kernel,<br>
  is done through shared memory and coordinated with such atomic<br>
  instructions.  Prior to this change, such arrangements usually<br>
  resulted in hangs, races or other synchronisation failures, because<br>
  Valgrind did not honour atomicity of such instructions.<br>
<br>
<br>
* A new experimental tool, BBV, has been added.  BBV generates basic<br>
  block vectors for use with the SimPoint analysis tool, which allows<br>
  a program's overall behaviour to be approximated by running only a<br>
  fraction of it.  This is useful for computer architecture<br>
  researchers.  You can run BBV by specifying --tool=exp-bbv (the<br>
  "exp-" prefix is short for "experimental").  BBV was written by<br>
  Vince Weaver.<br>
<br>
<br>
* Modestly improved support for running Windows applications under<br>
  Wine.  In particular, initial support for reading Windows .PDB debug<br>
  information has been added.<br>
<br>
<br>
* A new Memcheck client request VALGRIND_COUNT_LEAK_BLOCKS has been<br>
  added.  It is similar to VALGRIND_COUNT_LEAKS but counts blocks<br>
  instead of bytes.<br>
<br>
<br>
* The Valgrind client requests VALGRIND_PRINTF and<br>
  VALGRIND_PRINTF_BACKTRACE have been changed slightly.  Previously,<br>
  the string was always printed immediately on its own line.  Now, the<br>
  string will be added to a buffer but not printed until a newline is<br>
  encountered, or other Valgrind output is printed (note that for<br>
  VALGRIND_PRINTF_BACKTRACE, the back-trace itself is considered<br>
  "other Valgrind output").  This allows you to use multiple<br>
  VALGRIND_PRINTF calls to build up a single output line, and also to<br>
  print multiple output lines with a single request (by embedding<br>
  multiple newlines in the string).<br>
<br>
<br>
* The graphs drawn by Massif's ms_print program have changed slightly:<br>
<br>
  - The half-height chars '.' and ',' are no longer drawn, because<br>
    they are confusing.  The --y option can be used if the default<br>
    y-resolution is not high enough.<br>
<br>
  - Horizontal lines are now drawn after the top of a snapshot if<br>
    there is a gap until the next snapshot.  This makes it clear that<br>
    the memory usage has not dropped to zero between snapshots.<br>
<br>
<br>
* Something that happened in 3.4.0, but wasn't clearly announced: the<br>
  option --read-var-info=yes can be used by some tools (Memcheck,<br>
  Helgrind and DRD).  When enabled, it causes Valgrind to read DWARF3<br>
  variable type and location information.  This makes those tools<br>
  start up more slowly and increases memory consumption, but<br>
  descriptions of data addresses in error messages become more<br>
  detailed.<br>
<br>
<br>
* exp-Omega, an experimental instantaneous leak-detecting tool, was<br>
  disabled in 3.4.0 due to a lack of interest and maintenance,<br>
  although the source code was still in the distribution.  The source<br>
  code has now been removed from the distribution.  For anyone<br>
  interested, the removal occurred in SVN revision r10247.<br>
<br>
<br>
* Some changes have been made to the build system.<br>
<br>
  - VEX/ is now integrated properly into the build system.  This means<br>
    that dependency tracking within VEX/ now works properly, "make<br>
    install" will work without requiring "make" before it, and<br>
    parallel builds (ie. 'make -j') now work (previously a<br>
    .NOTPARALLEL directive was used to serialize builds, ie. 'make -j'<br>
    was effectively ignored).<br>
<br>
  - The --with-vex configure option has been removed.  It was of<br>
    little use and removing it simplified the build system.<br>
<br>
  - The location of some install files has changed.  This should not<br>
    affect most users.  Those who might be affected:<br>
<br>
    * For people who use Valgrind with MPI programs, the installed<br>
      libmpiwrap.so library has moved from<br>
      $(INSTALL)/&lt;platform&gt;/libmpiwrap.so to<br>
      $(INSTALL)/libmpiwrap-&lt;platform&gt;.so.<br>
<br>
    * For people who distribute standalone Valgrind tools, the<br>
      installed libraries such as $(INSTALL)/&lt;platform&gt;/libcoregrind.a<br>
      have moved to $(INSTALL)/libcoregrind-&lt;platform&gt;.a.<br>
<br>
    These changes simplify the build system.<br>
<br>
  - Previously, all the distributed suppression (*.supp) files were<br>
    installed.  Now, only default.supp is installed.  This should not<br>
    affect users as the other installed suppression files were not<br>
    read; the fact that they were installed was a mistake.<br>
<br>
<br>
* KNOWN LIMITATIONS:<br>
<br>
  - Memcheck is unusable with the Intel compiler suite version 11.1,<br>
    when it generates code for SSE2-and-above capable targets.  This<br>
    is because of icc's use of highly optimised inlined strlen<br>
    implementations.  It causes Memcheck to report huge numbers of<br>
    false errors even in simple programs.  Helgrind and DRD may also<br>
    have problems.<br>
<br>
    Versions 11.0 and earlier may be OK, but this has not been<br>
    properly tested.<br>
<br>
<br>
The following bugs have been fixed or resolved.  Note that "n-i-bz"<br>
stands for "not in bugzilla" -- that is, a bug that was reported to us<br>
but never got a bugzilla entry.  We encourage you to file bugs in<br>
bugzilla (http://bugs.kde.org/enter_valgrind_bug.cgi) rather than<br>
mailing the developers (or mailing lists) directly -- bugs that are<br>
not entered into bugzilla tend to get forgotten about or ignored.<br>
<br>
To see details of a given bug, visit<br>
https://bugs.kde.org/show_bug.cgi?id=XXXXXX<br>
where XXXXXX is the bug number as listed below.<br>
<br>
84303   How about a LockCheck tool? <br>
91633   dereference of null ptr in vgPlain_st_basetype <br>
97452   Valgrind doesn't report any pthreads problems <br>
100628  leak-check gets assertion failure when using <br>
        VALGRIND_MALLOCLIKE_BLOCK on malloc()ed memory <br>
108528  NPTL pthread cleanup handlers not called <br>
110126  Valgrind 2.4.1 configure.in tramples CFLAGS <br>
110128  mallinfo is not implemented... <br>
110770  VEX: Generated files not always updated when making valgrind<br>
111102  Memcheck: problems with large (memory footprint) applications <br>
115673  Vex's decoder should never assert <br>
117564  False positive: Syscall param clone(child_tidptr) contains<br>
        uninitialised byte(s) <br>
119404  executing ssh from inside valgrind fails <br>
133679  Callgrind does not write path names to sources with dwarf debug<br>
        info<br>
135847  configure.in problem with non gnu compilers (and possible fix) <br>
136154  threads.c:273 (vgCallgrind_post_signal): Assertion<br>
        '*(vgCallgrind_current_fn_stack.top) == 0' failed. <br>
136230  memcheck reports "possibly lost", should be "still reachable" <br>
137073  NULL arg to MALLOCLIKE_BLOCK causes crash <br>
137904  Valgrind reports a memory leak when using POSIX threads,<br>
        while it shouldn't <br>
139076  valgrind VT_GETSTATE error <br>
142228  complaint of elf_dynamic_do_rela in trivial usage <br>
145347  spurious warning with USBDEVFS_REAPURB <br>
148441  (wine) can't find memory leak in Wine, win32 binary <br>
        executable file.<br>
148742  Leak-check fails assert on exit <br>
149878  add (proper) check for calloc integer overflow <br>
150606  Call graph is broken when using callgrind control <br>
152393  leak errors produce an exit code of 0. I need some way to <br>
        cause leak errors to result in a nonzero exit code. <br>
157154  documentation (leak-resolution doc speaks about num-callers<br>
        def=4) + what is a loss record<br>
159501  incorrect handling of ALSA ioctls <br>
162020  Valgrinding an empty/zero-byte file crashes valgrind <br>
162482  ppc: Valgrind crashes while reading stabs information <br>
162718  x86: avoid segment selector 0 in sys_set_thread_area() <br>
163253  (wine) canonicaliseSymtab forgot some fields in DiSym <br>
163560  VEX/test_main.c is missing from valgrind-3.3.1 <br>
164353  malloc_usable_size() doesn't return a usable size <br>
165468  Inconsistent formatting in memcheck manual -- please fix <br>
169505  main.c:286 (endOfInstr):<br>
        Assertion 'ii-&gt;cost_offset == *cost_offset' failed <br>
177206  Generate default.supp during compile instead of configure<br>
177209  Configure valt_load_address based on arch+os <br>
177305  eventfd / syscall 323 patch lost<br>
179731  Tests fail to build because of inlining of non-local asm labels<br>
181394  helgrind: libhb_core.c:3762 (msm_write): Assertion <br>
        'ordxx == POrd_EQ || ordxx == POrd_LT' failed. <br>
181594  Bogus warning for empty text segment <br>
181707  dwarf doesn't require enumerations to have name <br>
185038  exp-ptrcheck: "unhandled syscall: 285" (fallocate) on x86_64 <br>
185050  exp-ptrcheck: sg_main.c:727 (add_block_to_GlobalTree):<br>
        Assertion '!already_present' failed.<br>
185359  exp-ptrcheck: unhandled syscall getresuid()<br>
185794  "WARNING: unhandled syscall: 285" (fallocate) on x86_64<br>
185816  Valgrind is unable to handle debug info for files with split<br>
        debug info that are prelinked afterwards <br>
185980  [darwin] unhandled syscall: sem_open <br>
186238  bbToIR_AMD64: disInstr miscalculated next %rip<br>
186507  exp-ptrcheck unhandled syscalls prctl, etc. <br>
186790  Suppression pattern used for leaks are not reported <br>
186796  Symbols with length&gt;200 in suppression files are ignored <br>
187048  drd: mutex PTHREAD_PROCESS_SHARED attribute missinterpretation<br>
187416  exp-ptrcheck: support for __NR_{setregid,setreuid,setresuid}<br>
188038  helgrind: hg_main.c:926: mk_SHVAL_fail: the 'impossible' happened<br>
188046  bashisms in the configure script<br>
188127  amd64-&gt;IR: unhandled instruction bytes: 0xF0 0xF 0xB0 0xA<br>
188161  memcheck: --track-origins=yes asserts "mc_machine.c:672<br>
        (get_otrack_shadow_offset_wrk): the 'impossible' happened."<br>
188248  helgrind: pthread_cleanup_push, pthread_rwlock_unlock, <br>
        assertion fail "!lock-&gt;heldBy" <br>
188427  Add support for epoll_create1 (with patch) <br>
188530  Support for SIOCGSTAMPNS<br>
188560  Include valgrind.spec in the tarball<br>
188572  Valgrind on Mac should suppress setenv() mem leak <br>
189054  Valgrind fails to build because of duplicate non-local asm labels <br>
189737  vex amd64-&gt;IR: unhandled instruction bytes: 0xAC<br>
189762  epoll_create syscall not handled (--tool=exp-ptrcheck)<br>
189763  drd assertion failure: s_threadinfo[tid].is_recording <br>
190219  unhandled syscall: 328 (x86-linux)<br>
190391  dup of 181394; see above<br>
190429  Valgrind reports lots of errors in ld.so with x86_64 2.9.90 glibc <br>
190820  No debug information on powerpc-linux<br>
191095  PATCH: Improve usbdevfs ioctl handling <br>
191182  memcheck: VALGRIND_LEAK_CHECK quadratic when big nr of chunks<br>
        or big nr of errors<br>
191189  --xml=yes should obey --gen-suppressions=all <br>
191192  syslog() needs a suppression on macosx <br>
191271  DARWIN: WARNING: unhandled syscall: 33554697 a.k.a.: 265 <br>
191761  getrlimit on MacOSX <br>
191992  multiple --fn-skip only works sometimes; dependent on order <br>
192634  V. reports "aspacem sync_check_mapping_callback: <br>
        segment mismatch" on Darwin<br>
192954  __extension__ missing on 2 client requests <br>
194429  Crash at start-up with glibc-2.10.1 and linux-2.6.29 <br>
194474  "INSTALL" file has different build instructions than "README"<br>
194671  Unhandled syscall (sem_wait?) from mac valgrind <br>
195069  memcheck: reports leak (memory still reachable) for <br>
        printf("%d', x) <br>
195169  drd: (vgDrd_barrier_post_wait):<br>
        Assertion 'r-&gt;sg[p-&gt;post_iteration]' failed. <br>
195268  valgrind --log-file doesn't accept ~/...<br>
195838  VEX abort: LibVEX_N_SPILL_BYTES too small for CPUID boilerplate <br>
195860  WARNING: unhandled syscall: unix:223 <br>
196528  need a error suppression for pthread_rwlock_init under os x? <br>
197227  Support aio_* syscalls on Darwin<br>
197456  valgrind should reject --suppressions=(directory) <br>
197512  DWARF2 CFI reader: unhandled CFI instruction 0:10 <br>
197591  unhandled syscall 27 (mincore) <br>
197793  Merge DCAS branch to the trunk == 85756, 142103<br>
197794  Avoid duplicate filenames in Vex <br>
197898  make check fails on current SVN <br>
197901  make check fails also under exp-ptrcheck in current SVN <br>
197929  Make --leak-resolution=high the default <br>
197930  Reduce spacing between leak reports <br>
197933  Print command line of client at start-up, and shorten preamble <br>
197966  unhandled syscall 205 (x86-linux, --tool=exp-ptrcheck)<br>
198395  add BBV to the distribution as an experimental tool <br>
198624  Missing syscalls on Darwin: 82, 167, 281, 347 <br>
198649  callgrind_annotate doesn't cumulate counters <br>
199338  callgrind_annotate sorting/thresholds are broken for all but Ir <br>
199977  Valgrind complains about an unrecognized instruction in the<br>
        atomic_incs test program<br>
200029  valgrind isn't able to read Fedora 12 debuginfo <br>
200760  darwin unhandled syscall: unix:284 <br>
200827  DRD doesn't work on Mac OS X <br>
200990  VG_(read_millisecond_timer)() does not work correctly <br>
201016  Valgrind does not support pthread_kill() on Mac OS <br>
201169  Document --read-var-info<br>
201323  Pre-3.5.0 performance sanity checking <br>
201384  Review user manual for the 3.5.0 release <br>
201585  mfpvr not implemented on ppc <br>
201708  tests failing because x86 direction flag is left set <br>
201757  Valgrind doesn't handle any recent sys_futex additions <br>
204377  64-bit valgrind can not start a shell script<br>
        (with #!/path/to/shell) if the shell is a 32-bit executable<br>
n-i-bz  drd: fixed assertion failure triggered by mutex reinitialization.<br>
n-i-bz  drd: fixed a bug that caused incorrect messages to be printed<br>
        about memory allocation events with memory access tracing enabled<br>
n-i-bz  drd: fixed a memory leak triggered by vector clock deallocation<br>
<br>
(3.5.0: 19 Aug 2009, vex r1913, valgrind r10846).<br>
<br>
<br>
<br>
Release 3.4.1 (28 February 2009)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.4.1 is a bug-fix release that fixes some regressions and assertion<br>
failures in debug info reading in 3.4.0, most notably incorrect stack<br>
traces on amd64-linux on older (glibc-2.3 based) systems. Various<br>
other debug info problems are also fixed.  A number of bugs in the<br>
exp-ptrcheck tool introduced in 3.4.0 have been fixed.<br>
<br>
In view of the fact that 3.4.0 contains user-visible regressions<br>
relative to 3.3.x, upgrading to 3.4.1 is recommended.  Packagers are<br>
encouraged to ship 3.4.1 in preference to 3.4.0.<br>
<br>
The fixed bugs are as follows.  Note that "n-i-bz" stands for "not in<br>
bugzilla" -- that is, a bug that was reported to us but never got a<br>
bugzilla entry.  We encourage you to file bugs in bugzilla<br>
(http://bugs.kde.org/enter_valgrind_bug.cgi) rather than mailing the<br>
developers (or mailing lists) directly -- bugs that are not entered<br>
into bugzilla tend to get forgotten about or ignored.<br>
<br>
n-i-bz  Fix various bugs reading icc-11 generated debug info<br>
n-i-bz  Fix various bugs reading gcc-4.4 generated debug info<br>
n-i-bz  Preliminary support for glibc-2.10 / Fedora 11<br>
n-i-bz  Cachegrind and Callgrind: handle non-power-of-two cache sizes,<br>
        so as to support (eg) 24k Atom D1 and Core2 with 3/6/12MB L2.<br>
179618  exp-ptrcheck crashed / exit prematurely<br>
179624  helgrind: false positive races with pthread_create and<br>
        recv/open/close/read<br>
134207  pkg-config output contains @VG_PLATFORM@<br>
176926  floating point exception at valgrind startup with PPC 440EPX<br>
181594  Bogus warning for empty text segment<br>
173751  amd64-&gt;IR: 0x48 0xF 0x6F 0x45 (even more redundant rex prefixes)<br>
181707  Dwarf3 doesn't require enumerations to have name<br>
185038  exp-ptrcheck: "unhandled syscall: 285" (fallocate) on x86_64<br>
185050  exp-ptrcheck: sg_main.c:727 (add_block_to_GlobalTree):<br>
        Assertion '!already_present' failed.<br>
185359  exp-ptrcheck unhandled syscall getresuid()<br>
<br>
(3.4.1.RC1:  24 Feb 2008, vex r1884, valgrind r9253).<br>
(3.4.1:      28 Feb 2008, vex r1884, valgrind r9293).<br>
<br>
<br>
<br>
Release 3.4.0 (2 January 2009)<br>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
3.4.0 is a feature release with many significant improvements and the<br>
usual collection of bug fixes.  This release supports X86/Linux,<br>
AMD64/Linux, PPC32/Linux and PPC64/Linux.  Support for recent distros<br>
(using gcc 4.4, glibc 2.8 and 2.9) has been added.<br>
<br>
3.4.0 brings some significant tool improvements.  Memcheck can now<br>
report the origin of uninitialised values, the thread checkers<br>
Helgrind and DRD are much improved, and we have a new experimental<br>
tool, exp-Ptrcheck, which is able to detect overruns of stack and<br>
global arrays.  In detail:<br>
<br>
* Memcheck is now able to track the origin of uninitialised values.<br>
  When it reports an uninitialised value error, it will try to show<br>
  the origin of the value, as either a heap or stack allocation.<br>
  Origin tracking is expensive and so is not enabled by default.  To<br>
  use it, specify --track-origins=yes.  Memcheck's speed will be<br>
  essentially halved, and memory usage will be significantly<br>
  increased.  Nevertheless it can drastically reduce the effort<br>
  required to identify the root cause of uninitialised value errors,<br>
  and so is often a programmer productivity win, despite running more<br>
  slowly.<br>
<br>
* A version (1.4.0) of the Valkyrie GUI, that works with Memcheck in<br>
  3.4.0, will be released shortly.<br>
<br>
* Helgrind's race detection algorithm has been completely redesigned<br>
  and reimplemented, to address usability and scalability concerns:<br>
<br>
  - The new algorithm has a lower false-error rate: it is much less<br>
    likely to report races that do not really exist.<br>
<br>
  - Helgrind will display full call stacks for both accesses involved<br>
    in a race.  This makes it easier to identify the root causes of<br>
    races.<br>
<br>
  - Limitations on the size of program that can run have been removed.<br>
<br>
  - Performance has been modestly improved, although that is very<br>
    workload-dependent.<br>
<br>
  - Direct support for Qt4 threading has been added.<br>
<br>
  - pthread_barriers are now directly supported.<br>
<br>
  - Helgrind works well on all supported Linux targets.<br>
<br>
* The DRD thread debugging tool has seen major improvements:<br>
<br>
  - Greatly improved performance and significantly reduced memory<br>
    usage.<br>
<br>
  - Support for several major threading libraries (Boost.Thread, Qt4,<br>
    glib, OpenMP) has been added.<br>
<br>
  - Support for atomic instructions, POSIX semaphores, barriers and<br>
    reader-writer locks has been added.<br>
<br>
  - Works now on PowerPC CPUs too.<br>
<br>
  - Added support for printing thread stack usage at thread exit time.<br>
<br>
  - Added support for debugging lock contention.<br>
<br>
  - Added a manual for Drd.<br>
<br>
* A new experimental tool, exp-Ptrcheck, has been added.  Ptrcheck<br>
  checks for misuses of pointers.  In that sense it is a bit like<br>
  Memcheck.  However, Ptrcheck can do things Memcheck can't: it can<br>
  detect overruns of stack and global arrays, it can detect<br>
  arbitrarily far out-of-bounds accesses to heap blocks, and it can<br>
  detect accesses heap blocks that have been freed a very long time<br>
  ago (millions of blocks in the past).<br>
<br>
  Ptrcheck currently works only on x86-linux and amd64-linux.  To use<br>
  it, use --tool=exp-ptrcheck.  A simple manual is provided, as part<br>
  of the main Valgrind documentation.  As this is an experimental<br>
  tool, we would be particularly interested in hearing about your<br>
  experiences with it.<br>
<br>
* exp-Omega, an experimental instantaneous leak-detecting tool, is no<br>
  longer built by default, although the code remains in the repository<br>
  and the tarball.  This is due to three factors: a perceived lack of<br>
  users, a lack of maintenance, and concerns that it may not be<br>
  possible to achieve reliable operation using the existing design.<br>
<br>
* As usual, support for the latest Linux distros and toolchain<br>
  components has been added.  It should work well on Fedora Core 10,<br>
  OpenSUSE 11.1 and Ubuntu 8.10.  gcc-4.4 (in its current pre-release<br>
  state) is supported, as is glibc-2.9.  The C++ demangler has been<br>
  updated so as to work well with C++ compiled by even the most recent<br>
  g++'s.<br>
<br>
* You can now use frame-level wildcards in suppressions.  This was a<br>
  frequently-requested enhancement.  A line "..." in a suppression now<br>
  matches zero or more frames.  This makes it easier to write<br>
  suppressions which are precise yet insensitive to changes in<br>
  inlining behaviour.<br>
<br>
* 3.4.0 adds support on x86/amd64 for the SSSE3 instruction set.<br>
<br>
* Very basic support for IBM Power6 has been added (64-bit processes only).<br>
<br>
* Valgrind is now cross-compilable.  For example, it is possible to<br>
  cross compile Valgrind on an x86/amd64-linux host, so that it runs<br>
  on a ppc32/64-linux target.<br>
<br>
* You can set the main thread's stack size at startup using the<br>
  new --main-stacksize= flag (subject of course to ulimit settings).<br>
  This is useful for running apps that need a lot of stack space.<br>
<br>
* The limitation that you can't use --trace-children=yes together<br>
  with --db-attach=yes has been removed.<br>
<br>
* The following bugs have been fixed.  Note that "n-i-bz" stands for<br>
  "not in bugzilla" -- that is, a bug that was reported to us but<br>
  never got a bugzilla entry.  We encourage you to file bugs in<br>
  bugzilla (http://bugs.kde.org/enter_valgrind_bug.cgi) rather than<br>
  mailing the developers (or mailing lists) directly.<br>
<br>
  n-i-bz  Make return types for some client requests 64-bit clean<br>
  n-i-bz  glibc 2.9 support<br>
  n-i-bz  ignore unsafe .valgrindrc's (CVE-2008-4865)<br>
  n-i-bz  MPI_Init(0,0) is valid but libmpiwrap.c segfaults<br>
  n-i-bz  Building in an env without gdb gives bogus gdb attach<br>
  92456   Tracing the origin of uninitialised memory<br>
  106497  Valgrind does not demangle some C++ template symbols<br>
  162222  ==106497<br>
  151612  Suppression with "..." (frame-level wildcards in .supp files)<br>
  156404  Unable to start oocalc under memcheck on openSUSE 10.3 (64-bit)<br>
  159285  unhandled syscall:25 (stime, on x86-linux)<br>
  159452  unhandled ioctl 0x8B01 on "valgrind iwconfig"<br>
  160954  ppc build of valgrind crashes with illegal instruction (isel)<br>
  160956  mallinfo implementation, w/ patch<br>
  162092  Valgrind fails to start gnome-system-monitor<br>
  162819  malloc_free_fill test doesn't pass on glibc2.8 x86<br>
  163794  assertion failure with "--track-origins=yes"<br>
  163933  sigcontext.err and .trapno must be set together<br>
  163955  remove constraint !(--db-attach=yes &amp;&amp; --trace-children=yes)<br>
  164476  Missing kernel module loading system calls<br>
  164669  SVN regression: mmap() drops posix file locks<br>
  166581  Callgrind output corruption when program forks<br>
  167288  Patch file for missing system calls on Cell BE<br>
  168943  unsupported scas instruction pentium<br>
  171645  Unrecognised instruction (MOVSD, non-binutils encoding)<br>
  172417  x86-&gt;IR: 0x82 ...<br>
  172563  amd64-&gt;IR: 0xD9 0xF5  -  fprem1<br>
  173099  .lds linker script generation error<br>
  173177  [x86_64] syscalls: 125/126/179 (capget/capset/quotactl)<br>
  173751  amd64-&gt;IR: 0x48 0xF 0x6F 0x45 (even more redundant prefixes)<br>
  174532  == 173751<br>
  174908  --log-file value not expanded correctly for core file<br>
  175044  Add lookup_dcookie for amd64<br>
  175150  x86-&gt;IR: 0xF2 0xF 0x11 0xC1 (movss non-binutils encoding)<br>
<br>
Developer-visible changes:<br>
<br>
* Valgrind's debug-info reading machinery has been majorly overhauled.<br>
  It can now correctly establish the addresses for ELF data symbols,<br>
  which is something that has never worked properly before now.<br>
<br>
  Also, Valgrind can now read DWARF3 type and location information for<br>
  stack and global variables.  This makes it possible to use the<br>
  framework to build tools that rely on knowing the type and locations<br>
  of stack and global variables, for example exp-Ptrcheck.<br>
<br>
  Reading of such information is disabled by default, because most<br>
  tools don't need it, and because it is expensive in space and time.<br>
  However, you can force Valgrind to read it, using the<br>
  --read-var-info=yes flag.  Memcheck, Helgrind and DRD are able to<br>
  make use of such information, if present, to provide source-level<br>
  descriptions of data addresses in the error messages they create.<br>
<br>
(3.4.0.RC1:  24 Dec 2008, vex r1878, valgrind r8882).<br>
(3.4.0:       3 Jan 2009, vex r1878, valgrind r8899).<br>
<br>
    </p></div>
</div>
<div>
<br><table class="nav" width="100%" cellspacing="3" cellpadding="2" border="0" summary="Navigation footer">
<tr>
<td rowspan="2" width="40%" align="left">
<a accesskey="p" href="dist.authors.html">&lt;&lt; 1. AUTHORS</a> </td>
<td width="20%" align="center"><a accesskey="u" href="dist.html">Up</a></td>
<td rowspan="2" width="40%" align="right"> <a accesskey="n" href="dist.news.old.html">3. OLDER NEWS &gt;&gt;</a>
</td>
</tr>
<tr><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td></tr>
</table>
</div>
</body>
</html>
